(window.webpackJsonpjacinto_rl=window.webpackJsonpjacinto_rl||[]).push([[0],{143:function(e,t,a){e.exports=a(327)},148:function(e,t,a){},149:function(e,t,a){},327:function(e,t,a){"use strict";a.r(t);var r=a(2),n=a.n(r),i=a(86),s=a.n(i),c=(a(148),a(149),a(6)),o=a(0),u=a(3),l=a(4),h=a(1),d=a(5),g=a(142),p=a.n(g),m="Title",f="Level",y="Lose",b="Win",v="CharacterSelect",O=a(18),k=a.n(O),j=a(27),E=a(56),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(!(e<=0))return new Promise((function(t){return setTimeout(t,e)}))},C=function(e,t,a){return Math.min(Math.max(e,t),a)},A=function(e){return e[Math.floor(Math.random()*e.length)]},w=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},T=function(e){return"".concat(e.x,",").concat(e.y)},R=function(e){return function(t,a){var r=e.map[t+","+a];return!!r&&e.tileKey[r.type].passable}},P=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:R,i=(e.map,n(e)),s=new E.b.AStar(t.x,t.y,i,{topology:r}),c=[];return s.compute(a.x,a.y,(function(e,t){c.push({x:e,y:t})})),c.slice(1)},S=function(e,t,a){return{x:_(e.x,t.x,a),y:_(e.y,t.y,a)}},_=function(e,t,a){return e+a*(t-e)},D=function(e,t){for(var a,r=[],n=function(e,t){var a=t.x-e.x,r=t.y-e.y;return Math.max(Math.abs(a),Math.abs(r))}(e,t),i=0;i<n;i++){var s=0===n?0:i/n;r.push((a=S(e,t,s),{x:Math.round(a.x),y:Math.round(a.y)}))}return r},N=function(e,t){return{x:e.x+t[0],y:e.y+t[1]}},I=function(e,t,a,r,n){return P(e,t,a,r).slice(0,n+1)},M=function(e){var t=Object.keys(e),a=A(t).split(",");return{coordinates:{x:parseInt(a[0]),y:parseInt(a[1])},text:a}},L=function(e){return e.filter((function(e){return e.hasOwnProperty("durability")}))},G=function(e){return 2/3*(Math.pow(e,3)-9*Math.pow(e,2)+32*e-18)},q=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=G(a),n=[],i=0;i<r;i++){var s=Math.round(e+Math.cos(2*Math.PI/r*i)*a),c=Math.round(t+Math.sin(2*Math.PI/r*i)*a);n.push({x:s,y:c})}return n},U=a(16),H=a.n(U),W=a(26),B=a.n(W),F=function e(t){var a=t.game,r=void 0===a?null:a,n=t.passable,i=void 0!==n&&n,s=t.name,c=void 0===s?"nameless":s;Object(o.a)(this,e);var u=B()();this.entityTypes=["Entity"],this.id=u,this.name=c,this.game=r,this.passable=i,this.active=!0},z=a(7),K=a(20),X="#424242",J="#606b79",V="#B7C3CD",Y="#CED5DD",Q="#E16264",Z={base03:"#002b36",base02:"#073642",base01:"#586e75",base00:"#657b83",base0:"#839496",base1:"#93a1a1",base2:"#eee8d5",base3:"#fdf6e3",yellow:"#b58900",orange:"#cb4b16",red:"#dc322f",magenta:"#d33682",violet:"#6c71c4",blue:"#268bd2",cyan:"#2aa198",green:"#859900"},$={GROUND:{background:Z.base03,foreground:Z.base01,character:".",sprite:"\ue8a2",passable:!0},FLOOR:{background:Z.base02,foreground:Z.base0,character:"",passable:!0},SAFE_FLOOR:{background:Z.base02,foreground:Z.base0,character:"",passable:!0},BURNT:{background:Z.base03,foreground:Z.red,character:"X",sprite:"\ue8bb",passable:!0,animation:[{background:Z.base03,foreground:Z.red,character:"X",sprite:"\ue8bb",passable:!0},{background:Z.base03,foreground:Z.red,character:"x",sprite:"\ue8bb",passable:!0},{background:Z.base03,foreground:Z.red,character:"X",sprite:"\ue8bb",passable:!0},{background:Z.base03,foreground:Z.orange,character:"x",sprite:"\ue8bb",passable:!0},{background:Z.base03,foreground:Z.orange,character:"X",sprite:"\ue8bb",passable:!0},{background:Z.base03,foreground:Z.yellow,character:"x",sprite:"\ue8bb",passable:!0},{background:Z.base03,foreground:Z.red,character:"X",sprite:"\ue8bb",passable:!0}]},WET:{background:Z.base03,foreground:Z.blue,character:"=",sprite:"\ue8ca",passable:!0,animation:[{background:Z.base03,foreground:Z.blue,character:"=",sprite:"\ue8ca",passable:!0},{background:Z.base03,foreground:Z.blue,character:"~",sprite:"\ue8ca",passable:!0},{background:Z.base03,foreground:Z.blue,character:"=",sprite:"\ue8ca",passable:!0},{background:Z.base03,foreground:Z.base0,character:"~",sprite:"\ue8ca",passable:!0},{background:Z.base03,foreground:Z.base1,character:"=",sprite:"\ue8ca",passable:!0},{background:Z.base03,foreground:Z.base1,character:"~",sprite:"\ue8ca",passable:!0},{background:Z.base03,foreground:Z.blue,character:"=",sprite:"\ue8ca",passable:!0}]},WALL:{background:Z.base02,foreground:Z.base2,character:"#",sprite:"\ue802",passable:!1},DOOR:{background:Z.base02,foreground:Z.base0,character:"+",sprite:"\ue86d",passable:!0},SAFE:{background:Z.base02,foreground:Z.green,character:"+",sprite:"\ue8b2",passable:!0},WATER:{animation:[{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#9dc3d3",character:"\u2591",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2592",passable:!1},{background:"#424242",foreground:"#8aa",character:"\u2593",passable:!1}],background:"#9dc3d3",character:"\u2591",passable:!1}},ee={N:[0,-1],NE:[1,-1],W:[-1,0],NW:[-1,-1],SW:[-1,1],S:[0,1],SE:[1,1],E:[1,0],NONE:[0,0]},te="HEAD",ae="TORSO",re="BACK",ne="HAND",ie="FEET",se=function(){return[{type:te,name:"head",item:null},{type:ae,name:"torso",item:null},{type:re,name:"back",item:null},{type:ne,name:"left_hand",item:null},{type:ne,name:"right_hand",item:null},{type:ie,name:"feet",item:null}]},ce=function(){return[{type:ne,name:"weapon",item:null}]},oe={point:{x_offset:0,y_offset:0,positions:[{x:0,y:0,taken:!1}]},triple_point:{x_offset:0,y_offset:0,positions:[{x:0,y:0,taken:!1},{x:0,y:0,taken:!1},{x:0,y:0,taken:!1}]},spread:{x_offset:1,y_offset:0,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:0,y:-1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:2,taken:!1},{x:1,y:-2,taken:!1}]},verticalLine:{x_offset:1,y_offset:1,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:0,y:-1,taken:!1}]},smallSquare:{x_offset:0,y_offset:0,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1}]},square:{x_offset:0,y_offset:0,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1}]},bigSquare:{x_offset:0,y_offset:0,positions:[{x:0,y:0,taken:!1},{x:0,y:1,taken:!1},{x:1,y:1,taken:!1},{x:1,y:0,taken:!1},{x:1,y:-1,taken:!1},{x:0,y:-1,taken:!1},{x:-1,y:-1,taken:!1},{x:-1,y:0,taken:!1},{x:-1,y:1,taken:!1},{x:0,y:1,taken:!1},{x:2,y:2,taken:!1},{x:2,y:0,taken:!1},{x:2,y:-2,taken:!1},{x:0,y:-2,taken:!1},{x:-2,y:-2,taken:!1},{x:-2,y:0,taken:!1},{x:-2,y:2,taken:!1}]},circle:{x_offset:0,y_offset:0,positions:[].concat(Object(K.a)(q(0,0,2)),Object(K.a)(q(0,0,3)))}},ue={default:{renderer:{character:"*",color:"black",background:"white"}},fail:{renderer:{character:"x",color:"black",background:"red"}},succede:{renderer:{character:"x",color:Z.base3,background:Z.green}},damage:{renderer:{character:"*",color:"darkred",background:"red"}},leaf:{renderer:{character:"\u2724",color:"#36635b",background:"#F0D8C0"}},water:{renderer:{character:"~",color:Z.base3,background:Z.blue}}},le=0,he=1,de=a(12),ge=function e(t){var a=t.name,r=void 0===a?"Resource":a,n=t.getResourceCost,i=void 0===n?function(){return null}:n,s=t.actorResourcePath,c=void 0===s?null:s,u=t.actorResourceGetter,l=void 0===u?null:u,h=t.actorResourceSetter,d=void 0===h?null:h,g=t.renderer,p=void 0===g?{background:"transparent",color:"black",character:"*"}:g;Object(o.a)(this,e),this.name=r,this.getResourceCost=i,this.actorResourcePath=c,this.actorResourceGetter=l,this.actorResourceSetter=d,this.renderer=p},pe=function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).name="Energy",a.actorResourcePath="energy",a.renderer={color:"black",background:"#ff9926",character:"8",sprite:"\ue8c5"},a}return Object(d.a)(t,e),t}(ge),me=function(){function e(t){var a=this,r=t.game,n=t.actor,i=t.label,s=void 0===i?"action label":i,c=t.hidden,u=void 0!==c&&c,l=t.energyCost,h=void 0===l?100:l,d=t.processDelay,g=void 0===d?50:d,p=t.particles,m=void 0===p?[]:p,f=t.renderer,y=void 0===f?null:f,b=t.particleTemplate,v=void 0===b?ue.default:b,O=t.onBefore,k=void 0===O?function(){return null}:O,j=t.onAfter,E=void 0===j?function(){return null}:j,x=t.onSuccess,C=void 0===x?function(){return null}:x,A=t.onFailure,w=void 0===A?function(){return null}:A,T=t.interrupt,R=void 0!==T&&T,P=t.requiredResources,S=void 0===P?[]:P;Object(o.a)(this,e),this.actor=n,this.game=r,this.label=s,this.hidden=u,this.energyCost=h,this.processDelay=g,this.particles=m,this.renderer=y,this.particleTemplate=v,this.onBefore=k,this.onAfter=E,this.onSuccess=C,this.onFailure=w,this.interrupt=R,this.requiredResources=[new pe({getResourceCost:function(){return a.energyCost}})].concat(Object(K.a)(S))}return Object(u.a)(e,[{key:"addParticle",value:function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(c.a)({},this.particleTemplate.renderer),n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:le,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=new Ot({game:this.game,name:"particle",passable:!0,life:e,pos:t,direction:a,energy:100,renderer:r,type:n,path:i});this.particles.push(s)}},{key:"removeDeadParticles",value:function(){this.particles=this.particles.filter((function(e){return e.life>0}))}},{key:"setAsNextAction",value:function(){this.actor.setNextAction(this)}},{key:"getEnergyCost",value:function(){return de.find(this.requiredResources,{name:"Energy"}).getResourceCost()}},{key:"getRequiredResourceName",value:function(){return de.map(this.requiredResources,"name")}},{key:"listPayableResources",value:function(){var e=this;return de.map(this.requiredResources,(function(t){var a=t.getResourceCost,r=t.actorResourcePath,n=t.actorResourceGetter,i=de.get(e.actor,r,null),s=!1;return null!==de.get(e.actor,n,null)?s=e.actor[n]()>=a():null!==i&&(s=i>=a()),Object(c.a)({canPay:s},t)}))}},{key:"canPayRequiredResources",value:function(){return!de.find(this.listPayableResources(),{canPay:!1})}},{key:"payRequiredResources",value:function(){var e=this;de.each(this.requiredResources,(function(t){var a=t.getResourceCost,r=t.actorResourcePath,n=t.actorResourceSetter,i=de.get(e.actor,r,null),s=a();return de.get(e.actor,n,null)?(e.actor[n](i-s),!0):!!i&&(e.actor[r]-=s,!0)}))}},{key:"perform",value:function(){return{success:!0,alternative:null}}}]),e}(),fe=function(e){function t(e){var a,r=e.processDelay,n=void 0===r?0:r,i=Object(z.a)(e,["processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).processDelay=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){return this.actor.energy-=this.energyCost,this.actor.destroy(),{success:!0,alternative:null}}}]),t}(me),ye=function(e){function t(e){var a,r=e.engine,n=Object(z.a)(e,["engine"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},n)))).engine=r,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!0,a=null,console.log("".concat(this.actor.name," is cranking its engine.")),e.prev=3,e.next=6,this.engine.start();case 6:this.actor.energy-=this.energyCost,e.next=14;break;case 9:e.prev=9,e.t0=e.catch(3),console.log("EngineCrank"),console.log(e.t0),a=new fe({game:this.game,actor:this.actor,energyCost:100});case 14:return e.abrupt("return",{success:t,alternative:a});case 15:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(){return e.apply(this,arguments)}}()}]),t}(me),be=function(e){return function(e){function t(e){var a,r=e.children,n=void 0===r?[]:r,i=e.engine,s=void 0===i?new jt({}):i,u=Object(z.a)(e,["children","engine"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("PARENT"),a.children=n,a.engine=s,a.isInitialized=!1,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"destroyChild",value:function(e){e.energy=0;var t=this.game.map[T(e.pos)];this.game.map[T(e.pos)].entities=t.entities.filter((function(t){return t.id!==e.id})),this.engine.actors=this.engine.actors.filter((function(t){return t.id!==e.id})),this.game.draw()}},{key:"canAttack",value:function(e){return!this.children.map((function(e){return e.id})).includes(e.id)}},{key:"initialize",value:function(){var e=this;this.isInitialized=!0,this.engine.game=this.game,this.engine.actors=this.children,this.engine.actors.forEach((function(t){t.game=e.game,t.destroy=function(){e.destroyChild(t)},t.canAttack=e.canAttack.bind(e),e.game.placeActorOnMap(t),e.engine.addActor(t),e.game.draw()}))}},{key:"getAction",value:function(e){return this.isInitialized||this.initialize(),new ye({game:e,actor:this,engine:this.engine,energyCost:100,processDelay:10})}}]),t}(e)},ve=a(9),Oe=a(31),ke=a.n(Oe),je=0,Ee=1,xe=2,Ce=function(){function e(t){var a=t.display;Object(o.a)(this,e);var r=B()();this.id=r,this.lifeTime=0,this.active=!0,this.display=a,this.node=null}return Object(u.a)(e,[{key:"getActive",value:function(){return!1}},{key:"initialize",value:function(){}},{key:"update",value:function(e){this.lifeTime+=e.timeDiff,this.active=this.getActive(),this.active||this.display.removeAnimation(this.id)}}]),e}(),Ae=function(e){function t(e){var a=Object.assign({},e);return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},a)))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getActive",value:function(){return!(this.lifeTime>500)}}]),t}(Ce),we=function(e){function t(e){var a,r=e.x,n=e.y,i=e.lerpDirection,s=void 0===i?-1:i,u=e.color,d=void 0===u?"#fff":u,g=Object(z.a)(e,["x","y","lerpDirection","color"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},g)))).x=r,a.y=n,a.lerpDirection=s,a.color=d,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getActive",value:function(){return this.active}},{key:"initialize",value:function(){this.active=!0;var e=new ke.a.Rect({name:"rect",x:this.display.tileWidth*this.x+(this.display.tileOffset+this.display.tileGutter),y:this.display.tileHeight*this.y+(this.display.tileOffset+this.display.tileGutter),offsetX:this.display.tileWidth/-4,offsetY:this.display.tileHeight/-4,width:this.display.tileWidth/2,height:this.display.tileHeight/2,fill:this.color,strokeEnabled:!1,transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1});this.display.animationLayer.add(e),this.node=e,Object(ve.a)(Object(h.a)(t.prototype),"initialize",this).call(this)}},{key:"update",value:function(e){var a=this.node.opacity();a>=1&&(this.lerpDirection=-1),a<=0&&(this.lerpDirection=1),a+=.05*this.lerpDirection,this.node.opacity(C(a,0,1)),Object(ve.a)(Object(h.a)(t.prototype),"update",this).call(this,e)}}]),t}(Ce),Te=function(){function e(t){var a=t.containerId,r=void 0===a?null:a,n=t.width,i=void 0===n?100:n,s=t.height,c=void 0===s?100:s,u=t.tileWidth,l=void 0===u?10:u,h=t.tileHeight,d=void 0===h?10:h,g=t.tileGutter,p=void 0===g?0:g,m=t.tileOffset,f=void 0===m?10:m,y=t.game,b=void 0===y?null:y;Object(o.a)(this,e),this.containerId=r,this.width=i,this.height=c,this.tileWidth=l,this.tileHeight=d,this.tileGutter=p,this.tileOffset=f,this.stage=null,this.layer=null,this.animationLayer=null,this.animations=[],this.animationLoop=null,this.game=b}return Object(u.a)(e,[{key:"initialize",value:function(e){var t=this,a=e.getElementById(this.containerId),r=e.createElement("div");a.appendChild(r),this.stage=new ke.a.Stage({container:"display",width:this.width,height:this.height}),this.layer=new ke.a.Layer({hitGraphEnabled:!1}),this.stage.add(this.layer),this.animationLayer=new ke.a.Layer({}),this.stage.add(this.animationLayer);var n=new ke.a.Animation((function(e){t.animations.forEach((function(t){return t.update(e)})),t.animations.length<=0&&t.animationLoop&&t.animationLoop.isRunning()&&t.animationLoop.stop()}),this.animationLayer);this.animationLoop=n,n.start()}},{key:"adjustContentToScreen",value:function(e){var t=(e.offsetWidth-this.tileOffset)/this.game.mapWidth;this.tileWidth=Math.floor(t),this.tileHeight=this.tileWidth,this.width=(this.game.mapWidth-1)*this.tileWidth+this.tileOffset,this.height=this.game.mapHeight*this.tileHeight+this.tileOffset}},{key:"addAnimation",value:function(e,t){var a;switch(e){case xe:a=new Ae(Object(c.a)({display:this},t));break;case Ee:a=new we(Object(c.a)({display:this},t));break;case je:default:a=new Ce(Object(c.a)({display:this},t))}return a.initialize(),this.animations.push(a),this.animationLoop.isRunning()||this.animationLoop.start(),a}},{key:"removeAnimation",value:function(e){this.animations=this.animations.filter((function(t){return t.id!==e||(t.node.destroy(),!1)}))}},{key:"updateAnimation",value:function(e){this.animations=this.animations.map((function(t){return t.id===e&&console.log(t),t}))}},{key:"updateTile",value:function(e,t,a,r){e&&(e.children[0].fill(r),e.children[1].fill(a),e.children[1].text(t))}},{key:"createTile",value:function(e,t,a,r,n){arguments.length>5&&void 0!==arguments[5]&&arguments[5],this.tileWidth,this.tileOffset,this.tileGutter,this.tileHeight,this.tileOffset,this.tileGutter;var i=new ke.a.Group({id:"".concat(e,",").concat(t),x:this.tileWidth*e+(this.tileOffset+this.tileGutter),y:this.tileHeight*t+(this.tileOffset+this.tileGutter),width:this.tileWidth,height:this.tileHeight,transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1}),s=new ke.a.Rect({name:"rect",width:this.tileWidth,height:this.tileHeight,fill:n,strokeEnabled:!1,transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1}),c=new ke.a.Text({name:"text",text:a,width:this.tileWidth,height:this.tileHeight,fontSize:this.tileWidth-4,fontFamily:"scroll-o-script",fill:r,align:"center",verticalAlign:"middle",transformsEnabled:"position",perfectDrawEnabled:!1,listening:!1,shadowForStrokeEnabled:!1});return i.add(s),i.add(c),this.layer.add(i),i}},{key:"getAbsoultueX",value:function(e){return this.tileWidth*e+(this.tileOffset+this.tileGutter)}},{key:"getAbsoultueY",value:function(e){return this.tileWidth*e+(this.tileOffset+this.tileGutter)}},{key:"getTilesWide",value:function(e,t,a){return Math.floor((e-t)/a)}},{key:"getTilesHigh",value:function(e,t,a){return Math.floor((e-t)/a)}},{key:"getTilesAcrossOnScreen",value:function(){return Math.floor(this.width/this.tileWidth)}},{key:"getTilesDownOnScreen",value:function(){return Math.floor(this.height/this.tileHeight)}},{key:"draw",value:function(){this.layer.batchDraw()}}]),e}(),Re={INFORMATION:{color:V,backgroundColor:X},ACTION:{color:J,backgroundColor:Y},DANGER:{color:Q,backgroundColor:X},STATUS_EFFECT:{color:Z.base3,backgroundColor:Z.violet},ERROR:{color:Z.base3,backgroundColor:Z.yellow}},Pe=function e(t){var a=t.text,r=void 0===a?"":a,n=t.type,i=void 0===n?Re.INFORMATION:n;Object(o.a)(this,e);var s=B()();this.id=s,this.text=r,this.type=i},Se=function(e){return function(e){function t(e){var a,r=e.attackDamage,n=void 0===r?1:r,i=Object(z.a)(e,["attackDamage"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("ATTACKING"),a.attackDamage=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAttackDamage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.attackDamage+e}},{key:"canAttack",value:function(e){return!0}},{key:"attack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=!1,r=this.game.map[T(e)];if(!r)return a;var n=L(r.entities);if(n.length>0){var i=n[0];if(this.canAttack(i)){var s=this.getAttackDamage(t);this.entityTypes.includes("EQUIPING")&&this.equipment.forEach((function(e){e.item&&e.item.entityTypes.includes("ATTACKING")&&(s+=e.item.getAttackDamage())})),this.game.addMessage("".concat(this.name," does ").concat(s," to ").concat(i.name),Re.DANGER),i.decreaseDurability(s),a=!0}}return a}}]),t}(e)},_e=function(e){return function(e){function t(e){var a,r=e.attackRange,n=void 0===r?0:r,i=e.baseRangedAccuracy,s=void 0===i?0:i,u=e.baseRangedDamage,d=void 0===u?0:u,g=e.magazineSize,p=void 0===g?0:g,m=Object(z.a)(e,["attackRange","baseRangedAccuracy","baseRangedDamage","magazineSize"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},m)))).entityTypes=a.entityTypes.concat("RANGED_ATTACKING"),a.attackRange=n,a.baseRangedAccuracy=s,a.baseRangedDamage=d,a.magazineSize=p,a.magazine=p,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getRangedAttackChance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.getRangedWeaponAccuracy(),a=e?this.getRangedAttackCoverDebuff(e):0,r=e?this.getRangedAttackDistanceDebuff(e):0,n=this.baseRangedAccuracy+t+a+r;return n}},{key:"getRangedAttackCoverDebuff",value:function(e){var t=this;return D(this.getPosition(),e).reduce((function(e,a){var r,n,i=t.game.map[T(a)],s=(r=i.entities,n="COVERING",r.filter((function(e){return e.entityTypes.includes(n)}))),c=0;return s.length>0&&(c=s[0].accuracyModifer),e+c}),0)}},{key:"getRangedAttackDistanceDebuff",value:function(e){return P(this.game,e,this.getPosition(),8).length/(3*this.getAttackRange())*-1}},{key:"getAttackRange",value:function(){var e=this.attackRange;return this.entityTypes.includes("EQUIPING")&&this.equipment.forEach((function(t){t.item&&t.item.entityTypes.includes("RANGED_ATTACKING")&&(e+=t.item.attackRange)})),e}},{key:"getRangedWeaponAccuracy",value:function(){var e=0;return this.entityTypes.includes("EQUIPING")&&this.equipment.forEach((function(t){t.item&&t.item.entityTypes.includes("RANGED_ATTACKING")&&(e+=t.item.getRangedAttackChance())})),e}},{key:"getRangedAttackDamage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.baseRangedDamage+this.getRangedWeaponDamage()+e}},{key:"getRangedWeaponDamage",value:function(){var e=0;return this.entityTypes.includes("EQUIPING")&&this.equipment.forEach((function(t){t.item&&t.item.entityTypes.includes("RANGED_ATTACKING")&&(e+=t.item.getRangedAttackDamage())})),e}},{key:"canRangedAttack",value:function(e){return!0}},{key:"getEquipedWeapons",value:function(){return this.entityTypes.includes("EQUIPING")?this.equipment.map((function(e){if(e.item&&e.item.entityTypes.includes("RANGED_ATTACKING"))return e.item})):[]}},{key:"useAmmo",value:function(){this.getEquipedWeapons().forEach((function(e){return e.magazine=Math.max(0,e.magazine-1)}))}},{key:"reload",value:function(){var e=this,t=!1;return this.entityTypes.includes("CONTAINING")&&this.getEquipedWeapons().forEach((function(a){for(var r=a.magazineSize-a.magazine,n=0;n<r;n++){var i=e.contains("Ammo");i&&(e.removeFromContainer(i),a.magazine+=1,t=!0)}})),t}},{key:"rangedAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!1,n=!1,i=this.game.map[T(e)];if(!i)return[r,n];var s=L(i.entities);if(s.length>0){var c=this.getRangedAttackChance(e),o=c+a;if(!(n=Math.random()<o))return[r=!0,n];this.useAmmo();var u=s[0];if(this.canRangedAttack(u)){var l=this.getRangedAttackDamage(t);this.game.addMessage("".concat(this.name," does ").concat(l," to ").concat(u.name),Re.DANGER),u.decreaseDurability(l),r=!0}}return[r,n]}}]),t}(e)},De=function(e){return function(e){function t(e){var a,r=e.name,n=void 0===r?"nameless":r,i=e.equipmentType,s=void 0===i?ne:i,u=Object(z.a)(e,["name","equipmentType"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("EQUIPABLE"),a.name=n,a.equipmentType=s,a}return Object(d.a)(t,e),t}(e)},Ne=function(e){return function(e){function t(e){var a,r=e.actions,n=void 0===r?[]:r,i=e.speed,s=void 0===i?100:i,u=(e.energy,Object(z.a)(e,["actions","speed","energy"]));return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("ACTING"),a.actions=n,a.speed=s,a.energy=s,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAction",value:function(){var e=A(this.actions);if(e)return e}},{key:"gainEnergy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.speed;this.energy+=e}},{key:"hasEnoughEnergy",value:function(){return this.energy>0}}]),t}(e)},Ie=function(e){return function(e){function t(e){var a,r=e.pos,n=void 0===r?{x:0,y:0}:r,i=e.renderer,s=Object(z.a)(e,["pos","renderer"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},s)))).entityTypes=a.entityTypes.concat("RENDERING"),a.pos=n,a.renderer=Object(c.a)({},i),a.currentFrame=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getRenderer",value:function(){return this.renderer}},{key:"getPosition",value:function(){return this.pos}},{key:"move",value:function(e){var t=this,a=!1;if(this.game.canOccupyPosition(e,this)){var r=this.game.map[T(this.pos)];this.game.map[T(this.pos)]=Object(c.a)({},r,{entities:r.entities.filter((function(e){return e.id!==t.id}))}),this.pos=e,this.game.map[T(e)].entities.push(this),a=!0}return a}},{key:"shove",value:function(e,t){var a=this.game.map[T(e)];return a&&a.entities.map((function(e){if(e.entityTypes.includes("PUSHABLE")&&!e.passable&&e.pushable){var a={x:e.pos.x+t[0],y:e.pos.y+t[1]};e.move(a)}})),this.move(e)}}]),t}(e)},Me=function e(t){var a=t.itemType,r=t.items;Object(o.a)(this,e),this.itemType=a,this.items=r},Le=function(e){return function(e){function t(e){var a,r=e.container,n=void 0===r?[]:r,i=Object(z.a)(e,["container"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("CONTAINING"),a.container=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"createSlot",value:function(e){var t=new Me({itemType:e.name,items:[e]});this.container.push(t)}},{key:"contains",value:function(e){var t=this.container.filter((function(t){return t.itemType===e}));return t.length>0&&t[0].items[0]}},{key:"addToContainer",value:function(e){var t=this.container.findIndex((function(t){return t.itemType===e.name}));t>=0?this.container[t].items.push(e):this.createSlot(e)}},{key:"removeFromContainer",value:function(e){var t=this;this.container.forEach((function(a,r){a.items=a.items.filter((function(t){return t.id!==e.id})),a.items.length||t.container.splice(r,1)}))}}]),t}(e)},Ge=a(21),qe={fire_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/fire-00.mp3"],volume:.5,loop:!0}),fire_1:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/fire-01.mp3"],volume:.05,loop:!0}),scream_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/scream-00.wav"]}),scream_1:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/scream-01.wav"]}),scream_2:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/scream-02.wav"]}),water_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/water-04.wav"]}),water_1:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/water-05.wav"]}),chop_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/chop-00.wav"]}),chop_1:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/chop-01.wav"]}),equip_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/equip-00.wav"]}),equip_1:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/equip-01.wav"]}),explosion_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/explosion-00.wav"],volume:.2}),save:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/save.wav"]}),lose:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/lose-00.wav"]}),grab_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/grab-00.wav"]}),release_0:new Ge.Howl({src:[window.PUBLIC_URL+"/sounds/grab-01.wav"]})},Ue=function(e){return function(e){function t(e){var a,r=e.keymap,n=void 0===r?{}:r,i=Object(z.a)(e,["keymap"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("PLAYING"),a.nextAction=null,a.keymap=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"setNextAction",value:function(e){this.nextAction=e}},{key:"getAction",value:function(){var e=this.nextAction;return this.nextAction=null,e}}]),t}(e)},He=function(e){if(e.energy=0,e.pos){var t=e.game.map[T(e.pos)];e.game.map[T(e.pos)].entities=t.entities.filter((function(t){return t.id!==e.id}))}e.game.engine.removeStatusEffectByActorId(e.id),e.game.draw(),e.active=!1},We=function(e){function t(e){var a,r=e.message,n=e.messageType,i=void 0===n?Re.INFORMATION:n,s=e.processDelay,u=void 0===s?50:s,d=Object(z.a)(e,["message","messageType","processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},d)))).message=r,a.messageType=i,a.processDelay=u,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){return this.game.addMessage("".concat(this.actor.name,' says "').concat(this.message,'"'),this.messageType),{success:!0,alternative:null}}}]),t}(me),Be=function(e){function t(e){var a,r=e.targetPos,n=e.additionalDamage,i=void 0===n?0:n,s=e.processDelay,u=void 0===s?100:s,d=Object(z.a)(e,["targetPos","additionalDamage","processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},d)))).targetPos=r,a.additionalDamage=i,a.processDelay=u,a.particleTemplate=ue.damage,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e;if(!this.actor.entityTypes.includes("ATTACKING"))return{success:!0,alternative:new We({message:"Ooh I don't know how to attack",game:this.game,actor:this.actor,energyCost:0})};(e=this.actor.attack(this.targetPos,this.additionalDamage))&&(A([qe.chop_0,qe.chop_1]).play(),this.addParticle(1,Object(c.a)({},this.targetPos),{x:0,y:0}));return{success:e,alternative:null}}}]),t}(me),Fe=function(e){function t(e){var a,r=e.targetPos,n=e.processDelay,i=void 0===n?25:n,s=Object(z.a)(e,["targetPos","processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},s)))).targetPos=r,a.processDelay=i,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.move(this.targetPos)?e=!0:(e=!0,t=new Be({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:0})),{success:e,alternative:t}}}]),t}(me),ze=function(e){function t(e){var a=Object.assign({},e);return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},a)))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1,a=null;this.actor.passable=!1;var r=Object(ve.a)(Object(h.a)(t.prototype),"perform",this).call(this);(r.success&&(this.actor.path.shift(),e=!0),0===this.actor.path.length&&(e=!0,a=new fe({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),r.alternative)&&(this.actor.attack(this.targetPos)&&(a=new fe({game:this.game,actor:this.actor,energyCost:100,processDelay:0})));return{success:e,alternative:a}}}]),t}(Fe),Ke=function(e){function t(e){var a,r=e.damageToSelf,n=Object(z.a)(e,["damageToSelf"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},n)))).damageToSelf=r,a.onSuccess=function(){console.log("Self destruct success"),a.actor.decreaseDurabilityWithoutDefense(r)},a.onFailure=function(){console.log("Self destruct fails"),a.actor.destroy()},a}return Object(d.a)(t,e),t}(Be),Xe=function(e){function t(e){var a,r=e.targetPos,n=e.damageToSelf,i=void 0===n?1:n,s=e.processDelay,u=void 0===s?25:s,d=Object(z.a)(e,["targetPos","damageToSelf","processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},d)))).targetPos=r,a.processDelay=u,a.damageToSelf=i,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.move(this.targetPos)?(this.actor.energy-=this.energyCost,e=!0):(e=!0,t=new Ke({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100,damageToSelf:this.damageToSelf})),{success:e,alternative:t}}}]),t}(me),Je=function(e){return function(e){function t(e){var a,r=e.path,n=void 0!==r&&r,i=e.direction,s=void 0===i?{x:0,y:0}:i,u=e.attackDamage,d=void 0===u?1:u,g=e.range,p=void 0===g?3:g,m=Object(z.a)(e,["path","direction","attackDamage","range"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},m)))).entityTypes=a.entityTypes.concat("DIRECTIONAL_PROJECTING"),a.path=n,a.direction=s,a.attackDamage=d,a.range=p,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"createPath",value:function(e){for(var t=[],a=1;a<this.range+1;a++)t.push({x:this.pos.x+this.direction[0]*a,y:this.pos.y+this.direction[1]*a});this.path=t}},{key:"getAction",value:function(e){var t=this,a={x:this.pos.x+this.direction[0],y:this.pos.y+this.direction[1]};return this.passable=!1,this.range>0?new Xe({targetPos:a,game:e,actor:this,energyCost:100,damageToSelf:1,onSuccess:function(){return t.range-=1},onAfter:function(){t.energy<=100&&e.engine.setActorToPrevious()}}):new fe({game:e,actor:this,energyCost:0})}}]),t}(e)},Ve=function(e){function t(e){var a,r=e.targetPos,n=e.direction,i=Object(z.a)(e,["targetPos","direction"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).targetPos=r,a.direction=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1,t=null;return this.actor.shove(this.targetPos,this.direction)?(this.actor.energy-=this.energyCost,e=!0):(e=!0,t=new Be({targetPos:this.targetPos,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(me),Ye=function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).processDelay=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1,a=null;this.actor.passable=!1;var r=Object(ve.a)(Object(h.a)(t.prototype),"perform",this).call(this);return r.success&&(this.actor.path.shift(),e=!0),0===this.actor.path.length&&(e=!0,a=new fe({game:this.game,actor:this.actor,energyCost:100,processDelay:0})),r.alternative&&this.actor.attack(this.targetPos),{success:e,alternative:a}}}]),t}(Fe),Qe=function(e){return function(e){function t(e){var a,r=e.targetEntity,n=void 0===r?null:r,i=Object(z.a)(e,["targetEntity"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("CHASING"),a.targetEntity=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAction",value:function(e){if(this.targetEntity){var t=P(e,this.targetEntity.pos,this.pos),a=t.length>0?t[0]:this.pos;return new Fe({targetPos:a,game:e,actor:this,energyCost:100})}return new We({message:"Where are they?",game:e,actor:this,energyCost:100})}}]),t}(e)},Ze=function(e){function t(e){var a,r=e.targetPos,n=e.entity,i=e.interrupt,s=void 0===i||i,u=e.forcePlacement,d=void 0!==u&&u,g=Object(z.a)(e,["targetPos","entity","interrupt","forcePlacement"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},g)))).targetPos=r,a.entity=n,a.interrupt=s,a.forcePlacement=d,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1,t=!!this.forcePlacement||this.game.canOccupyPosition(this.targetPos,this.entity),a=this.game.map[T(this.targetPos)];return t&&a&&(this.entity.pos=this.targetPos,a.entities.push(this.entity),this.game.engine.addActorAsNext(this.entity),e=!0),{success:e,alternative:null}}}]),t}(me),$e=function(e){return function(e){function t(e){var a,r=e.draggable,n=void 0===r||r,i=Object(z.a)(e,["draggable"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).draggable=n,a.entityTypes=a.entityTypes.concat("DRAGGABLE"),a}return Object(d.a)(t,e),t}(e)},et=function(e){return function(e){function t(e){var a,r=e.pushable,n=void 0===r||r,i=Object(z.a)(e,["pushable"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).pushable=n,a.entityTypes=a.entityTypes.concat("PUSHABLE"),a}return Object(d.a)(t,e),t}(e)},tt="Directional Kunai",at=function(e,t,a,r){return new ft({game:e.game,direction:a,passable:!0,pos:{x:t.x,y:t.y},renderer:{character:">",color:"white",background:"",animation:[{background:"lightgrey",color:"grey",character:">"},{background:"lightgrey",color:"grey",character:"v"},{background:"lightgrey",color:"grey",character:"<"},{background:"lightgrey",color:"grey",character:"^"},{background:"lightgrey",color:"grey",character:">"}]},name:tt,speed:600,energy:0,range:r})},rt=function(e){return function(e){function t(e){var a,r=e.durability,n=void 0===r?1:r,i=e.defense,s=void 0===i?0:i,u=e.onDestroy,d=void 0===u?function(){return null}:u,g=Object(z.a)(e,["durability","defense","onDestroy"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},g)))).entityTypes=a.entityTypes.concat("DESTRUCTABLE"),a.durability=n,a.durabilityMax=n,a.defense=s,a.onDestroy=d,a.actorSprite=a.renderer.sprite,a.actorCharacter=a.renderer.character,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getDefense",value:function(){var e=this.defense;return this.entityTypes.includes("EQUIPING")&&this.equipment.forEach((function(t){t.item&&t.item.entityTypes.includes("DESTRUCTABLE")&&(e+=t.item.getDefense())})),e}},{key:"decreaseDurabilityWithoutDefense",value:function(e){this.durability-=e,this.durability<=0&&(this.onDestroy(this),this.destroy())}},{key:"decreaseDurability",value:function(e){var t=this.durability,a=t-(e-this.getDefense());this.durability=Math.min(t,a),this.updateActorRenderer(),this.durability<=0&&(this.onDestroy(this),this.destroy())}},{key:"increaseDurability",value:function(e){this.durability+=e,this.updateActorRenderer()}},{key:"updateActorRenderer",value:function(){this.durability===this.durabilityMax?(this.renderer.sprite=this.actorSprite,this.renderer.character=this.actorCharacter):(this.renderer.sprite=this.durability,this.renderer.character=this.durability),this.game.draw()}},{key:"destroy",value:function(){He(this)}}]),t}(e)},nt=function(e){return function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).entityTypes=a.entityTypes.concat("BURNABLE"),a.canBurn=!0,a.willResetCanBurn=!1,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"resetCanBurn",value:function(){this.willResetCanBurn=!1,this.canBurn=!0}},{key:"burn",value:function(){return!!this.canBurn&&(this.decreaseDurability(2),!0)}}]),t}(e)},it=function(e){return function(e){function t(e){var a,r=e.flammability,n=void 0===r?1:r,i=e.explosivity,s=void 0===i?1:i,u=Object(z.a)(e,["flammability","explosivity"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("EXPLODING"),a.flammability=n,a.explosivity=s,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"enflame",value:function(){var e=this;Array(this.flammability).fill("").map((function(t){return new bt({name:"Pyro",pos:Object(c.a)({},e.pos),game:e.game,renderer:{character:"*",color:Z.base3,background:Z.red},timeToSpread:1,spreadCount:1,durability:1,attackDamage:1,speed:100})})).forEach((function(t){e.game.placeActorOnMap(t),e.game.engine.addActor(t)}))}},{key:"explode",value:function(){var e=this,t={x_offset:0,y_offset:0,positions:Array(this.explosivity).fill("").reduce((function(e,t,a){return e.concat.apply(e,Object(K.a)(q(0,0,a+1)))}),[])};t.positions.forEach((function(a){var r={x:e.pos.x+a.x+t.x_offset,y:e.pos.y+a.y+t.y_offset},n=e.game.map[T(r)];if(n){n.type="BURNT";var i=L(n.entities);i.length>0&&i.forEach((function(t){var a=e.attackDamage?e.attackDamage:e.explosivity;e.game.addMessage("".concat(e.name," does ").concat(a," to ").concat(t.name),Re.DANGER),t.decreaseDurability(a)}))}})),this.explosivity>0&&qe.explosion_0.play()}},{key:"destroy",value:function(){this.enflame(),this.explode(),Object(ve.a)(Object(h.a)(t.prototype),"destroy",this).call(this)}}]),t}(e)},st=a(25),ct=function(e){return function(e){function t(e){var a,r=e.initializeKeymap,n=Object(z.a)(e,["initializeKeymap"]);Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},n)))).entityTypes=a.entityTypes.concat("HAS_KEYMAP"),a.keymapStack=[],a.initializeKeymap=r;var i=r(a.game.engine,Object(st.a)(a));return a.addKeymap(i),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getKeymap",value:function(){return de.get(this.keymapStack,"0",null)}},{key:"addKeymap",value:function(e){this.keymapStack.unshift(e)}},{key:"removeKeymap",value:function(){this.keymapStack.shift()}},{key:"reinitializeKeymap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keymapStack=[];var t=this.initializeKeymap(this.game.engine,this);e.forEach((function(e){return delete t[e]})),this.addKeymap(t)}},{key:"setKeymap",value:function(e){return this.addKeymap(e),this.getKeymap}},{key:"goToPreviousKeymap",value:function(){return this.removeKeymap(),this.getKeymap()}}]),t}(e)},ot=function(e){var t=e.activate,a=void 0===t?function(e){return null}:t,r=e.canUpgrade,n=void 0===r?function(e){return!0}:r,i=e.cost,s=void 0===i?1:i,c=e.name,o=void 0===c?"upgrade":c,u=e.removeOnActivate;return{activate:a,canUpgrade:n,cost:s,name:o,removeOnActivate:void 0!==u&&u}},ut=function(e){return function(e){function t(e){var a,r=e.faction,n=void 0===r?null:r,i=Object(z.a)(e,["faction"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("HAS_FACTION"),a.faction=n,a}return Object(d.a)(t,e),t}(e)},lt=(H()(Ne,Ie,Ue,ct,(function(e){return function(e){function t(e){var a,r=e.initiatedBy,n=void 0===r?null:r,i=e.range,s=void 0===i?null:i,u=Object(z.a)(e,["initiatedBy","range"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("UI"),a.initiatedBy=n,a.active=!0,a.range=s,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"hasEnoughEnergy",value:function(){return this.active}}]),t}(e)}))(F),H()(Ne,Ie)(F),H()(Ne,Ie,rt,(function(e){return function(e){function t(e){var a,r=e.messages,n=void 0===r?["I have nothing to say."]:r,i=e.messageType,s=Object(z.a)(e,["messages","messageType"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},s)))).entityTypes=a.entityTypes.concat("SPEAKING"),a.messages=n,a.messageType=i,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAction",value:function(e){var t=this.messages.shift();return this.messages.push(t),new We({actor:this,game:e,message:t,messageType:this.messageType,processDelay:0})}}]),t}(e)}),$e,et,nt,(function(e){return function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).entityTypes=a.entityTypes.concat("HELPLESS"),a.saved=!1,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"save",value:function(){this.saved=!0,qe.save.play()}},{key:"destroy",value:function(){A([qe.scream_0,qe.scream_1,qe.scream_2]).play(),Object(ve.a)(Object(h.a)(t.prototype),"destroy",this).call(this)}}]),t}(e)}))(F),H()(Ie,rt)(F),H()(Ie,(function(e){return function(e){function t(e){var a,r=e.accuracyModifer,n=void 0===r?0:r,i=e.damageModifer,s=void 0===i?0:i,u=Object(z.a)(e,["accuracyModifer","damageModifer"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("COVERING"),a.providesCover=!0,a.accuracyModifer=n,a.damageModifer=s,a}return Object(d.a)(t,e),t}(e)}),rt)(F)),ht=(H()(Ie,Le,$e,nt,rt,it,et)(F),H()(Ne,Ie,(function(e){return function(e){function t(e){var a,r=e.path,n=void 0!==r&&r,i=e.direction,s=void 0===i?{x:0,y:0}:i,u=e.range,d=void 0===u?3:u,g=Object(z.a)(e,["path","direction","range"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},g)))).entityTypes=a.entityTypes.concat("DIRECTIONAL_PUSHING"),a.path=n,a.direction=s,a.range=d,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAction",value:function(e){var t=this,a={x:this.pos.x+this.direction[0],y:this.pos.y+this.direction[1]};return this.passable=!1,this.range>0?new Ve({targetPos:a,direction:this.direction,game:e,actor:this,energyCost:100,onSuccess:function(){return t.range-=1}}):new fe({game:e,actor:this,energyCost:0})}}]),t}(e)}),rt)(F),H()(Ne,Ie,Qe,rt)(F),H()(Ne,Ie,Qe,rt,Se,et,ut)(F)),dt=H()(Ne,Ie,(function(e){return function(e){function t(e){var a,r=e.targetEntity,n=void 0===r?null:r,i=e.getProjectile,s=void 0===i?function(){return null}:i,u=Object(z.a)(e,["targetEntity","getProjectile"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("RANGED_CHASING"),a.targetEntity=n,a.getProjectile=s,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"targetInPath",value:function(e,t){var a=!1;return e.forEach((function(e){e.x===t.x&&e.y===t.y&&(a=!0)})),a}},{key:"getAction",value:function(e){if(!this.targetEntity)return new We({message:"Where are they?",game:e,actor:this,energyCost:100});var t={x:Math.sign(this.targetEntity.pos.x-this.pos.x),y:Math.sign(this.targetEntity.pos.y-this.pos.y)},a=this.getProjectile({pos:{x:this.pos.x,y:this.pos.y},targetPos:Object(c.a)({},this.targetEntity.pos),direction:[t.x,t.y],range:10});if(a.createPath(e),this.targetInPath(a.path,this.targetEntity.pos))return e.canOccupyPosition(a.pos,a)?new Ze({targetPos:Object(c.a)({},a.pos),entity:a,game:e,actor:this,energyCost:100}):new We({message:"I'll get you with this kunai!",game:e,actor:this,energyCost:100});var r=P(e,this.targetEntity.pos,this.pos),n=r.length>0?r[0]:this.pos;return new Fe({targetPos:n,game:e,actor:this,energyCost:100})}}]),t}(e)}),rt,Se,et,ut)(F),gt=H()(Ne,Ie,(function(e){return function(e){function t(e){var a,r=e.presentingUI,n=void 0!==r&&r,i=Object(z.a)(e,["presentingUI"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("PRESENTING_UI"),a.presentingUI=n,a}return Object(d.a)(t,e),t}(e)}),(function(e){return function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).entityTypes=a.entityTypes.concat("HAS_TARGETING_CURSOR"),a.cursorIsActive=!1,a.cursorPositions=[],a.animations=[],a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"setCursorIsActive",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.cursorIsActive=e}},{key:"activateCursor",value:function(e){this.setCursorPositions(e),this.setCursorIsActive(!0),this.resetAnimations()}},{key:"deactivateCursor",value:function(){this.setCursorIsActive(!1),this.removeAnimations()}},{key:"getCursorPositions",value:function(){return this.cursorPositions}},{key:"setCursorPositions",value:function(e){return this.cursorPositions=e,this.getCursorPositions()}},{key:"addAnimations",value:function(){var e=this,t=this.getCursorPositions();if(t.length){t.forEach((function(t){var a=e.game.display.addAnimation(Ee,{x:t.x,y:t.y+0,color:Z.base3});e.animations.push(a)}))}}},{key:"removeAnimations",value:function(){var e=this;this.animations.length&&this.animations.forEach((function(t){return e.game.display.removeAnimation(t.id)})),this.animations=[]}},{key:"resetAnimations",value:function(){this.removeAnimations(),this.addAnimations()}},{key:"moveCursorInDirection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this.getCursorPositions().map((function(a){return{x:a.x+e[0]*t,y:a.y+e[1]*t}}));return this.setCursorPositions(a),this.resetAnimations(),a}},{key:"changeCursorColor",value:function(e,t){this.animations[e].node.fill(t)}}]),t}(e)}),ct,(function(e){return function(e){function t(e){var a,r=e.draggedEntity,n=void 0===r?null:r,i=Object(z.a)(e,["draggedEntity"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("DRAGGING"),a.draggedEntity=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"grab",value:function(e){var t=this.game.map[T(e)];if(!t)return!1;if(t.entities.length>0){var a=t.entities[0];if(a.entityTypes.includes("DRAGGABLE")&&!this.draggedEntity&&!0===a.draggable)return this.draggedEntity=a,!0}return!1}},{key:"release",value:function(){if(!this.draggedEntity)return!1;var e=Object(c.a)({},this.draggedEntity);return this.draggedEntity=null,e}},{key:"drag",value:function(e){var t=this,a=this.draggedEntity.pos,r=this.game.map[T(a)];this.game.map[T(a)]=Object(c.a)({},r,{entities:r.entities.filter((function(e){return e.id!==t.draggedEntity.id}))}),this.draggedEntity.pos=e,this.game.map[T(e)].entities.push(this.draggedEntity)}},{key:"move",value:function(e){var a=Object(c.a)({},this.pos);if(this.draggedEntity){var r=Object(ve.a)(Object(h.a)(t.prototype),"move",this).call(this,e);return r?(this.drag(a),!0):r}return Object(ve.a)(Object(h.a)(t.prototype),"move",this).call(this,e)}}]),t}(e)}),(function(e){return function(e){function t(e){var a,r=e.charge,n=void 0===r?2:r,i=Object(z.a)(e,["charge"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("CHARGING"),a.charge=n,a.chargeMax=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"decreaseCharge",value:function(e){this.charge=Math.max(0,this.charge-e)}},{key:"increaseCharge",value:function(e){this.charge=Math.min(this.chargeMax,this.charge+e)}}]),t}(e)}),(function(e){return function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).entityTypes=a.entityTypes.concat("SIGNING"),a.signHistory=[],a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"addSign",value:function(e){this.signHistory.length>=4&&this.signHistory.shift(),this.signHistory.push(e)}},{key:"clearSigns",value:function(){this.signHistory=[]}}]),t}(e)}),Le,(function(e){return function(e){function t(e){var a,r=e.equipment,n=void 0===r?se():r,i=Object(z.a)(e,["equipment"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("EQUIPING"),a.equipment=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"hasItemNameEquipped",value:function(e){return this.equipment.filter((function(t){return!(!t.item||t.item.name!==e)})).length>0}},{key:"getItemInSlot",value:function(e){if(this.equipment.filter((function(t){return null===t.item&&t.type===e})).length>0)return!1;var t=this.equipment.find((function(t){return t.type===e}));return!!t&&(!!t.item&&t.item)}},{key:"equip",value:function(e,t){var a=!1;return this.equipment=this.equipment.map((function(r){return a||r.type!==e||null!==r.item||(r.item=t,a=!0,qe.equip_1.play()),r})),a}},{key:"unequip",value:function(e){this.equipment=this.equipment.map((function(t){return t.item&&t.item.id===e.id&&(t.item=null,qe.equip_0.play()),t}))}}]),t}(e)}),Se,_e,rt,(function(e){return function(e){function t(e){var a,r=e.cloneLimit,n=void 0===r?1:r,i=Object(z.a)(e,["cloneLimit"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).entityTypes=a.entityTypes.concat("CLONING"),a.cloneLimit=n,a.clones=[],a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"destroy",value:function(){this.clones&&this.clones.map((function(e){He(e)})),He(this)}},{key:"destroyClone",value:function(e){var t=this.clones.findIndex((function(t){return t.id===e}));t>=0&&(this.clones[t].super__destroy(),this.clones.splice(t,1))}},{key:"createClone",value:function(e){var t=this;if(this.clones.length<this.cloneLimit){var a=Object(de.cloneDeep)(this);if(a.name="Clone",a.game=this.game,a.id=B()(),a.entityTypes.includes("HAS_KEYMAP")){var r=Object(de.find)(e,{attribute:"ignoredKeys"});a.reinitializeKeymap(r?r.value:[])}if(delete a.clones,a.super__destroy=a.destroy,a.destroy=function(){t.destroyClone(a.id)},e.forEach((function(e){a[e.attribute]=e.value})),this.game.placeActorOnMap(a))return this.game.engine.addActorAsNext(a),this.game.draw(),this.clones.push(a),!0}return!1}}]),t}(e)}),Ue,nt,(function(e){return function(e){function t(e){var a,r=e.upgrade_points,n=void 0===r?0:r,i=e.upgrade_tree,s=void 0===i?[]:i,u=Object(z.a)(e,["upgrade_points","upgrade_tree"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("UPGRADABLE"),a.upgrade_points=n,a.upgrade_tree=s,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"upgrade",value:function(e){if(e.canUpgrade(this)){if(e.activate(this),e.removeOnActivate){var t=this.upgrade_tree.filter((function(t){return t.name!==e.name}));this.upgrade_tree=t}return!0}return!1}}]),t}(e)}),ut)(F),pt=(H()(Ie,De,Se)(F),H()(Ie,De,_e,Se,(function(e){return function(e){function t(e){var a,r=e.shapePattern,n=void 0===r?oe.point:r,i=Object(z.a)(e,["shapePattern"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).shapePattern=n,a.entityTypes=a.entityTypes.concat("HAS_SHAPE_PATTERN"),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getPositionsInShape",value:function(e){return t=this.shapePattern,a=e,t.positions.map((function(e){return{x:a.x+e.x+t.x_offset,y:a.y+e.y+t.y_offset}}));var t,a}}]),t}(e)}))(F)),mt=(H()(Ie,De,rt)(F),H()(Ie)(F)),ft=(H()(Ne,Ie,Se,(function(e){return function(e){function t(e){var a,r=e.path,n=void 0!==r&&r,i=e.targetPos,s=void 0===i?null:i,u=e.attackDamage,d=void 0===u?1:u,g=e.range,p=void 0===g?3:g,m=Object(z.a)(e,["path","targetPos","attackDamage","range"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},m)))).entityTypes=a.entityTypes.concat("DESTRUCTIVE_PROJECTING"),a.path=n,a.targetPos=s,a.attackDamage=d,a.range=p,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"createPath",value:function(e){var t=I(e,this.targetPos,this.pos,8,this.range);this.path=t}},{key:"getAction",value:function(e){this.path||this.createPath(e);var t=this.path.length>0?this.path[0]:this.pos;return new ze({targetPos:t,game:e,actor:this,energyCost:100})}}]),t}(e)}),rt)(F),H()(Ne,Ie,Se,Je,rt)(F)),yt=H()(Ne,Ie,Se,Je,rt,it)(F),bt=(H()(Ne,Ie,Se,(function(e){return function(e){function t(e){var a,r=e.owner_id,n=void 0===r?null:r,i=e.path,s=void 0!==i&&i,u=e.targetPos,d=void 0===u?null:u,g=e.attackDamage,p=void 0===g?1:g,m=e.range,f=void 0===m?3:m,y=Object(z.a)(e,["owner_id","path","targetPos","attackDamage","range"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},y)))).entityTypes=a.entityTypes.concat("GASEOUS_DESTRUCTIVE_PROJECTING"),a.path=s,a.targetPos=d,a.attackDamage=p,a.range=f,a.owner_id=n,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"canAttack",value:function(e){var a=Object(ve.a)(Object(h.a)(t.prototype),"canAttack",this).call(this);return a&&(a=null===this.owner_id||e.owner_id!==this.owner_id),a}},{key:"createPath",value:function(e){var t=I(e,this.targetPos,this.pos,8,this.range);this.path=t}},{key:"getAction",value:function(e){this.path||this.createPath(e);var t=this.path.length>0?this.path[0]:this.pos;return new Ye({targetPos:t,game:e,actor:this,energyCost:100})}}]),t}(e)}),rt,(function(e){return function(e){function t(e){var a,r=e.isClone,n=void 0!==r&&r,i=e.cloneCount,s=void 0===i?0:i,u=e.clonePattern,d=void 0===u?oe.square:u,g=Object(z.a)(e,["isClone","cloneCount","clonePattern"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},g)))).entityTypes=a.entityTypes.concat("GASEOUS"),a.isClone=n,a.cloneCount=s,a.clonePattern=Object(de.cloneDeep)(d),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAction",value:function(e){var a=this.clonePattern.positions.find((function(e){return!e.taken}));if(!this.isClone&&a){a.taken=!0;var r=Object(de.cloneDeepWith)(this,(function(e,t){switch(t){case"id":case"game":case"engine":case"clones":return null;default:return}}));if(r.game=e,r.id=B()(),this.hasOwnProperty("pos")){var n=this.pos;r.pos={x:n.x+a.x,y:n.y+a.y}}r.hasOwnProperty("path")&&(r.path=r.path.map((function(e){return{x:e.x+a.x,y:e.y+a.y}}))),r.isClone=!0,this.cloneCount+=1,e.placeActorOnMap(r),e.engine.addActor(r),e.draw()}return Object(ve.a)(Object(h.a)(t.prototype),"getAction",this).call(this,e)}}]),t}(e)}))(F),H()(Ne,rt,be)(F),H()(Ne,Ie,rt,Se,(function(e){return function(e){function t(e){var a,r=e.timeToSpread,n=void 0===r?5:r,i=e.spreadCount,s=void 0===i?1:i,u=Object(z.a)(e,["timeToSpread","spreadCount"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).entityTypes=a.entityTypes.concat("SPREADING"),a.timeToSpreadMax=n,a.timeToSpread=n,a.spreadCountMax=s,a.spreadCount=s,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAction",value:function(e){var t=this;if(this.spreadCount<=0)return new fe({game:e,actor:this,energyCost:100,processDelay:0,onAfter:function(){e.map[T(t.pos)].type="BURNT"}});if(this.timeToSpread<=0){for(var a=[{x:this.pos.x+0,y:this.pos.y+0},{x:this.pos.x+1,y:this.pos.y+0},{x:this.pos.x+-1,y:this.pos.y+0},{x:this.pos.x+0,y:this.pos.y+1},{x:this.pos.x+0,y:this.pos.y+-1}],r=null,n=100;n>0;){var i=A(a),s=this.game.map[T(i)],c=Boolean(s),o=!0,u=!1;if(s&&(o="BURNT"!==s.type,u=["WALL","FLOOR","DOOR"].includes(s.type)),c&&o&&u){r=i;break}n-=1}if(r){var l=new bt({name:"Pyro",pos:{x:0,y:0},game:e,renderer:{character:"*",sprite:"\ue8bb",color:Z.base3,background:Z.red},timeToSpread:this.timeToSpreadMax,spreadCount:this.spreadCountMax,durability:this.durability,attackDamage:this.attackDamage,speed:this.speed});return this.timeToSpread=this.timeToSpreadMax,this.spreadCount-=1,new Ze({targetPos:r,entity:l,game:e,actor:this,interrupt:!1,energyCost:100,processDelay:0,forcePlacement:!0})}this.timeToSpread=this.timeToSpreadMax,this.spreadCount-=1}return this.timeToSpread-=1,new We({message:"burning",game:e,actor:this,processDelay:0})}}]),t}(e)}))(F)),vt=H()(Ne,Ie,rt,(function(e){return function(e){function t(e){var a,r=e.getSpawnedEntity,n=e.timeToSpread,i=void 0===n?5:n,s=e.spreadCount,u=void 0===s?1:s,d=Object(z.a)(e,["getSpawnedEntity","timeToSpread","spreadCount"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},d)))).entityTypes=a.entityTypes.concat("SPAWNING"),a.timeToSpreadMax=i,a.timeToSpread=i,a.spreadCountMax=u,a.spreadCount=u,a.getSpawnedEntity=r,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getAction",value:function(e){if(this.spreadCount<=0)return new fe({game:e,actor:this,energyCost:100,processDelay:0});if(this.timeToSpread<=0){for(var t=[{x:this.pos.x+1,y:this.pos.y+0},{x:this.pos.x+-1,y:this.pos.y+0},{x:this.pos.x+0,y:this.pos.y+1},{x:this.pos.x+0,y:this.pos.y+-1}],a=null,r=100;r>0;){var n=A(t),i=this.game.map[T(n)];if(Boolean(i)&&e.canOccupyPosition(n)){a=n;break}r-=1}if(a)return this.timeToSpread=this.timeToSpreadMax,this.spreadCount-=1,new Ze({targetPos:a,entity:this.getSpawnedEntity(a),game:e,actor:this,interrupt:!1,energyCost:100,processDelay:0,forcePlacement:!0});this.timeToSpread=this.timeToSpreadMax,this.spreadCount-=1}return this.timeToSpread-=1,new We({message:"boom boom",game:e,actor:this,processDelay:0})}}]),t}(e)}),ut)(F),Ot=H()(Ne,Ie,(function(e){return function(e){function t(e){var a,r=e.pos,n=void 0===r?{x:1,y:1}:r,i=e.direction,s=void 0===i?{x:0,y:0}:i,u=e.life,d=void 0===u?1:u,g=e.speed,p=void 0===g?1:g,m=e.type,f=void 0===m?le:m,y=e.path,b=void 0===y?null:y,v=Object(z.a)(e,["pos","direction","life","speed","type","path"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},v)))).pos=n,a.direction=s,a.life=d,a.speed=p,a.type=f,a.path=b,a.entityTypes=a.entityTypes.concat("PARTICLE"),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"getNextPos",value:function(e){switch(this.type){case le:return{x:this.pos.x+this.direction.x*this.speed*e,y:this.pos.y+this.direction.y*this.speed*e};case he:var t=this.path.shift();return t?Object(c.a)({},t):Object(c.a)({},this.pos)}}},{key:"update",value:function(e){this.life-=e,this.life>0&&(this.pos=this.getNextPos(e))}}]),t}(e)}))(F),kt=(H()(Ne,rt,be)(F),function(){function e(t){var a=t.statusEffects,r=void 0===a?[]:a,n=t.actors,i=void 0===n?[]:n,s=t.currentActor,c=void 0===s?0:s,u=t.isRunning,l=void 0!==u&&u,h=t.game,d=void 0===h?null:h;Object(o.a)(this,e),this.statusEffects=r,this.actors=i,this.currentActor=c,this.isRunning=l,this.game=d}return Object(u.a)(e,[{key:"processV1",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t,a,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.actors[this.currentActor]).gainEnergy(t.speed),!t.hasEnoughEnergy()){e.next=18;break}if(a=t.getAction(this.game)){e.next=6;break}return e.abrupt("return",!1);case 6:return r=a.perform(),this.game.draw(),e.next=11,x(a.processDelay);case 11:if(r.success){e.next=13;break}return e.abrupt("return",!1);case 13:if(null!==r.alternative){e.next=15;break}return e.abrupt("break",18);case 15:a=r.alternative,e.next=6;break;case 18:return this.currentActor=(this.currentActor+1)%this.actors.length,e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processV2",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t,a,r,n,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.actors[this.currentActor],null!==this.game.getFirstPlayer()){e.next=3;break}return e.abrupt("return",!1);case 3:a=!0;case 4:if(!a){e.next=52;break}if(t){e.next=7;break}return e.abrupt("return",!1);case 7:if(t.active){e.next=9;break}return e.abrupt("break",52);case 9:if(r=0,!t.hasEnoughEnergy()){e.next=48;break}if(n=t.getAction(this.game)){e.next=14;break}return e.abrupt("return",!1);case 14:r+=n.getEnergyCost();case 15:if(i={success:!1,alternative:null},!n.canPayRequiredResources()){e.next=24;break}return n.onBefore(),e.next=21,n.perform();case 21:(i=e.sent).success?(n.onSuccess(),n.payRequiredResources()):n.onFailure(),n.onAfter();case 24:return e.next=26,this.processActionFX(n,i.success);case 26:if(e.sent){e.next=35;break}if(!this.shouldAutoRun()){e.next=32;break}return e.next=30,x(25);case 30:e.next=34;break;case 32:return e.next=34,x(n.processDelay);case 34:this.game.draw();case 35:if(t.active){e.next=37;break}return e.abrupt("break",42);case 37:if(null!==i.alternative){e.next=39;break}return e.abrupt("break",42);case 39:n=i.alternative,e.next=15;break;case 42:if(this.processStatusEffects(r),!n.interrupt){e.next=46;break}return a=!1,e.abrupt("break",52);case 46:e.next=50;break;case 48:t.gainEnergy(t.speed),a=!1;case 50:e.next=4;break;case 52:return this.actors=this.actors.filter((function(e){return e.active})),this.currentActor+=1,this.currentActor>=this.actors.length&&(this.currentActor=0),e.abrupt("return",!0);case 56:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processV3",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t,a,r,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.actors[this.currentActor]){e.next=3;break}return e.abrupt("return",!1);case 3:if(a=0,!t.hasEnoughEnergy()){e.next=29;break}if(r=t.getAction(this.game)){e.next=8;break}return e.abrupt("return",!1);case 8:a+=r.energyCost;case 9:return e.next=12,r.perform();case 12:return n=e.sent,e.next=15,this.processActionFX(r,n.success);case 15:if(e.sent){e.next=19;break}return e.next=18,x(r.processDelay);case 18:this.game.draw();case 19:if(n.success){e.next=21;break}return e.abrupt("return",!1);case 21:if(null!==n.alternative){e.next=23;break}return e.abrupt("break",26);case 23:r=n.alternative,e.next=9;break;case 26:this.processStatusEffects(a),e.next=30;break;case 29:t.gainEnergy(t.speed);case 30:return this.currentActor=(this.currentActor+1)%this.actors.length,0===this.currentActor&&this.sortActorsByEnergy(),e.abrupt("return",!0);case 33:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isRunning=!0;case 1:if(!this.isRunning){e.next=7;break}return e.next=4,this.processV2();case 4:this.isRunning=e.sent,e.next=1;break;case 7:if(t=this.actors[this.currentActor]){e.next=10;break}return e.abrupt("return",!1);case 10:return this.setVisibleKeymap(t),this.game.updateMode(),e.next=14,this.game.updateReact(this.game);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.isRunning=!1}},{key:"setVisibleKeymap",value:function(e){if(e.entityTypes.includes("HAS_KEYMAP")){var t=e.getKeymap();t&&(this.game.visibleKeymap=t)}}},{key:"sortActorsByEnergy",value:function(){this.actors=this.actors.sort((function(e,t){return t.energy-e.energy}))}},{key:"shouldAutoRun",value:function(){return!this.actors.filter((function(e){return e.entityTypes.includes("PLAYING")})).length}},{key:"addStatusEffect",value:function(e){return!e.allowDuplicates&&this.statusEffects.filter((function(t){return t.actor.id===e.actor.id&&t.name===e.name})).length>0?(console.log("".concat(e.name," cannot be applied twice to ").concat(e.actor.name)),!1):(e.onStart(),this.statusEffects.push(e),!0)}},{key:"removeStatusEffectById",value:function(e){this.statusEffects=this.statusEffects.filter((function(t){return t.id!==e||(t.onStop(),!1)}))}},{key:"removeStatusEffectByActorId",value:function(e){this.statusEffects=this.statusEffects.filter((function(t){return t.actor.id!==e||(t.onStop(),!1)}))}},{key:"removeDeadStatusEffects",value:function(){this.statusEffects=this.statusEffects.filter((function(e){return!(e.lifespan>=0&&e.timeToLive<=0)||(e.onStop(),!1)}))}},{key:"getStatusEffectsByActorId",value:function(e){return this.statusEffects.filter((function(t){return t.actor.id===e}))}},{key:"processStatusEffects",value:function(e){this.statusEffects.forEach((function(t){t.timeSinceLastStep+=e,t.timeToLive-=e,t.timeSinceLastStep>=t.stepInterval&&(t.onStep(),t.timeSinceLastStep=0)})),this.removeDeadStatusEffects()}},{key:"processActionFX",value:function(){var e=Object(j.a)(k.a.mark((function e(t,a){var r,n=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=11;break}return r=new Ot({game:this.game,name:"particle",passable:!0,pos:Object(c.a)({},t.actor.pos),renderer:ue.fail.renderer}),this.game.placeActorOnMap(r),this.game.draw(),e.next=6,x(100);case 6:return this.game.removeActorFromMap(r),r.update(1),this.game.draw(),t.removeDeadParticles(),e.abrupt("return",!0);case 11:if(!t.particles.length){e.next=23;break}case 12:if(!(t.particles.length>0)){e.next=22;break}return t.particles.forEach((function(e){n.game.placeActorOnMap(e)})),this.game.draw(),e.next=17,x(t.processDelay);case 17:t.particles.forEach((function(e){n.game.removeActorFromMap(e),e.update(1)})),this.game.draw(),t.removeDeadParticles(),e.next=12;break;case 22:return e.abrupt("return",!0);case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"addActor",value:function(e){this.actors.push(e)}},{key:"addActorAsPrevious",value:function(e){this.actors.splice(this.currentActor,0,e)}},{key:"addActorAsNext",value:function(e){this.actors.splice(this.currentActor+1,0,e)}},{key:"setActorToPrevious",value:function(e){this.currentActor-=1,this.currentActor<=-1&&(this.currentActor=this.actors.length-1)}},{key:"setActorToNext",value:function(e){this.currentActor=(this.currentActor+1)%this.actors.length}}]),e}()),jt=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"process",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t,a,r,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.actors[this.currentActor],a=!0;case 2:if(!a){e.next=26;break}if(!t.hasEnoughEnergy()){e.next=23;break}if(r=t.getAction(this.game)){e.next=7;break}return e.abrupt("return",!1);case 7:return this.game.draw(),e.next=11,r.perform();case 11:return n=e.sent,e.next=14,x(r.processDelay);case 14:if(n.success){e.next=16;break}return e.abrupt("return",!1);case 16:if(null!==n.alternative){e.next=18;break}return e.abrupt("break",21);case 18:r=n.alternative,e.next=7;break;case 21:e.next=24;break;case 23:a=!1;case 24:e.next=2;break;case 26:if(this.currentActor+=1,!(this.currentActor+1>=this.actors.length)){e.next=31;break}return this.currentActor=0,this.actors.forEach((function(e){return e.gainEnergy(e.speed)})),e.abrupt("return",!1);case 31:return e.abrupt("return",!0);case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"start",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isRunning=!0;case 1:if(!this.isRunning){e.next=7;break}return e.next=4,this.process();case 4:this.isRunning=e.sent,e.next=1;break;case 7:return t=this.actors[this.currentActor],this.setVisibleKeymap(t),this.game.mode.update(),e.next=12,this.game.updateReact(this.game);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),t}(kt),Et=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"GROUND",i=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,o=0;o<s;o++)for(var u=0;u<c;u++)if(o>=t.y&&o<=t.y+(a-1)&&u>=t.x&&u<=t.x+(r-1)){var l="".concat(u,",").concat(o),h=0;e[n].animation&&(h=w(0,e[n].animation.length)),i[l]={type:n,currentFrame:h,entities:[]}}},xt=function(e,t,a){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,i=(arguments.length>5&&void 0!==arguments[5]&&arguments[5],{}),s=Ct(),c=1e3;s.length<r+1;){var o=At(s);if(o){var u=Rt(o,t,a,n),l=St(e,u,n,0);l&&s.push(o)}if((c-=1)<=0)break}return _t(e),Dt(e,s.length),i},Ct=function(){return[{x:0,y:0}]},At=function(e){for(var t=A(e),a=wt(t),r=Tt(a,e),n=1e3;r;)if(t=A(e.filter((function(e){return r=t,!((a=e).x===r.x&&a.y===r.y);var a,r}))),a=wt(t),r=Tt(a,e),(n-=1)<=0){r=!1,a=!1;break}return a},wt=function(e){return A(Pt(e))},Tt=function(e,t){return t.filter((function(t){return t.x===e.x&&t.y===e.y})).length>0},Rt=function(e,t,a,r){return{x:e.x+t+r*e.x,y:e.y+a+r*e.y}},Pt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[{x:e.x,y:e.y+1},{x:e.x+1,y:e.y},{x:e.x,y:e.y-1},{x:e.x-1,y:e.y}];return t&&(a=a.concat([{x:e.x+1,y:e.y+1},{x:e.x+1,y:e.y-1},{x:e.x-1,y:e.y-1},{x:e.x-1,y:e.y+1}])),a},St=function(e,t,a,r){for(var n=a+1-r,i=!1,s=0;s<n;s++)for(var c=0;c<n;c++){var o={x:t.x+s,y:t.y+c};e[T(o)]||(i=!0)}if(!i)for(var u=0;u<n;u++)for(var l=0;l<n;l++){var h={x:t.x+u,y:t.y+l},d="FLOOR";0!==u&&u!==n-1||(d="WALL"),0!==l&&l!==n-1||(d="WALL");var g=e[T(h)];g&&(g.type=d)}return!i},_t=function(e){Object.keys(e).filter((function(t){return"WALL"===e[t].type})).filter((function(t){var a=t.split(",").map((function(e){return parseInt(e)})),r={x:a[0],y:a[1]};return 8===Pt(r,!0).filter((function(t){var a=e[T(t)];return!(!a||!["WALL","FLOOR"].includes(a.type))})).length})).forEach((function(t){e[t].type="FLOOR"}))},Dt=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=Object.keys(e).filter((function(t){if("WALL"!==e[t].type)return!1;var a=t.split(",").map((function(e){return parseInt(e)})),r={x:a[0],y:a[1]};return 2===Pt(r,!1).filter((function(t){var a=e[T(t)];return!(!a||!["GROUND"].includes(a.type))})).length})),r=0;r<t;){var n=A(a),i=n.split(",").map((function(e){return parseInt(e)})),s={x:i[0],y:i[1]},o=Pt(s,!1).filter((function(t){var a=e[T(t)];return!(!a||!["WALL"].includes(a.type))})),u=A(o);if(u){for(var l={x:Math.sign(u.x-s.x),y:Math.sign(u.y-s.y)},h=100,d=!0,g=Object(c.a)({},s),p=[];d;){g.x+=l.x,g.y+=l.y;var m=e[T(g)];if(!m)break;if("FLOOR"===m.type)m.type="WALL",p.push(Object(c.a)({},g));else if("GROUND"===m.type||"WALL"===m.type&&p.length){var f={x:g.x-2*l.x,y:g.y-2*l.y};e[T(f)].type="DOOR",f={x:g.x-3*l.x,y:g.y-3*l.y},e[T(f)].type="DOOR",p.length<=0&&t<=100&&(t+=1);break}(h-=1)<=0&&(d=!1)}r+=1}}},Nt=a(55),It="#07111D",Mt="#02252e",Lt="#073642",Gt="#586e75",qt="#93a1a1",Ut="#fdf6e3",Ht="#b58900",Wt="#cb4b16",Bt="#dc322f",Ft="#859900",zt="#27295f",Kt="#3e7dc9",Xt="#423a18",Jt="#96641D",Vt="#E19D3F",Yt="#833139",Qt="#CC7468",Zt="#DDA78F",$t="#6D7886",ea={GROUND:{background:Mt,foreground:Gt,character:".",sprite:"\ue8a2",passable:!0},EMERGENCE_DESTROYED:{background:It,foreground:Xt,character:"",sprite:"\ue805",passable:!0},EMERGENCE_GROUND:{background:Xt,foreground:Jt,character:".",sprite:"\ue803",passable:!0},EMERGENCE_OUTER_GROUND:{background:Xt,foreground:Vt,character:".",sprite:"\ue8a3",passable:!0},FLOOR:{background:Lt,foreground:Jt,character:"",passable:!0},WALL:{background:Xt,foreground:Vt,character:"#",sprite:"\ue802",passable:!1},DOOR:{background:Xt,foreground:qt,character:"+",sprite:"\ue86d",passable:!0},SAFE:{background:Mt,foreground:Gt,character:".",sprite:"\ue8a2",passable:!0},LOCKED_EXIT:{background:Mt,foreground:Gt,character:".",sprite:"\ue8a2",passable:!0},EXIT:{background:Mt,foreground:Ft,character:">",sprite:"\ue8b1",passable:!0},BURNT:{background:Mt,foreground:Bt,character:"X",sprite:"\ue8bb",passable:!0,animation:[{background:Mt,foreground:Ht,character:"X",sprite:"\ue8a4",passable:!0},{background:Mt,foreground:Ht,character:"x",sprite:"\ue8a4",passable:!0},{background:Mt,foreground:Bt,character:"X",sprite:"\ue8a4",passable:!0},{background:Mt,foreground:Wt,character:"x",sprite:"\ue8a4",passable:!0},{background:Mt,foreground:Wt,character:"X",sprite:"\ue8a4",passable:!0},{background:Mt,foreground:Bt,character:"x",sprite:"\ue8a4",passable:!0},{background:Mt,foreground:Bt,character:"X",sprite:"\ue8a4",passable:!0}]}},ta={amount:{background:It,foreground:Vt,character:""},attackRange:{background:Ft,foreground:Ut,character:"==>"},magazine:{background:$t,foreground:Ut,character:"!!"},baseRangedAccuracy:{background:"#6c71c4",foreground:Ut,character:"*"},baseRangedDamage:{background:Bt,foreground:Ut,character:"x",sprite:"\ue890"},meleeDamage:{background:Bt,foreground:Ut,character:"x",sprite:"\ue888"}},aa=function(e){return new mt({game:e.game,name:"Ammo",passable:!0,renderer:{character:"||",sprite:"\ue891",background:$t,color:Ut}})},ra=function(e,t){return new yt({game:e.game,name:"Grenade",passable:!0,renderer:{character:"x",sprite:"\ue83a",color:Bt,background:Lt},flammability:0,explosivity:3,attackDamage:10,speed:100*t,energy:0,range:t})},na={Jacinto:function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).data={level:1,highestLevel:null,turnCount:0},a.dataByLevel=[{enemies:Array(4).fill("Grub"),emergenceHoles:1,ammoLoot:2,grenadeLoot:1},{enemies:Array(6).fill("Grub"),emergenceHoles:3,ammoLoot:1,grenadeLoot:0},{enemies:Array(12).fill("Grub"),emergenceHoles:0,ammoLoot:3,grenadeLoot:1},{enemies:[],emergenceHoles:5,ammoLoot:2,grenadeLoot:0},{enemies:Array(10).fill("Grub"),emergenceHoles:4,ammoLoot:1,grenadeLoot:0},{enemies:[],emergenceHoles:12,ammoLoot:20,grenadeLoot:5},{enemies:[].concat(Object(K.a)(Array(4).fill("Grub")),["Skorge"]),emergenceHoles:6,ammoLoot:20,grenadeLoot:2}],a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"initialize",value:function(){var e=this;Object(ve.a)(Object(h.a)(t.prototype),"initialize",this).call(this),this.game.tileKey=ea,this.game.createEmptyLevel(),this.game.initializeMapTiles(),this.setWaveData(),Et(this.game.tileKey,{x:0,y:0},this.game.mapHeight,1,"SAFE",this.game.map,this.game.mapHeight,this.game.mapWidth),Et(this.game.tileKey,{x:this.game.mapWidth-3,y:0},this.game.mapHeight,3,"LOCKED_EXIT",this.game.map,this.game.mapHeight,this.game.mapWidth),xt(this.game.map,10,10,2,4),xt(this.game.map,20,5,6,4),xt(this.game.map,30,5,10,4),this.placePlayersInSafeZone();var a=this.game.getFirstPlayer();a&&(a.upgrade_points+=1);var r=Object.keys(this.game.map).filter((function(t){return"GROUND"===e.game.map[t].type})),n=Object.keys(this.game.map).filter((function(t){return"FLOOR"===e.game.map[t].type}));this.data.enemies.forEach((function(t){var a=A(r).split(",").map((function(e){return parseInt(e)}));e["add".concat(t)]({x:a[0],y:a[1]})}));for(var i=0;i<40;i++){var s=A(r).split(",").map((function(e){return parseInt(e)}));this.addCover({x:s[0],y:s[1]})}for(var c=0;c<this.data.emergenceHoles;c++){var o=A(r).split(",").map((function(e){return parseInt(e)}));this.addEmerenceHole({x:o[0],y:o[1]})}for(var u=0;u<this.data.ammoLoot;u++){var l=A(n).split(",").map((function(e){return parseInt(e)}));this.addAmmoLoot({x:l[0],y:l[1]})}for(var d=0;d<this.data.grenadeLoot;d++){var g=A(n).split(",").map((function(e){return parseInt(e)}));this.addGrenadeLoot({x:g[0],y:g[1]})}}},{key:"getPlayers",value:function(){return this.game.engine.actors.filter((function(e){return e.entityTypes.includes("PLAYING")}))}},{key:"updateUI",value:function(){var e=this;de.each(this.getPlayers(),(function(t,a){var r=Math.floor(t.energy/100),n=Math.floor(t.speed/100),i=[].concat(Object(K.a)(Array(r).fill("\ue8b2")),Object(K.a)(Array(n-r).fill("_")));e.createOrUpdateInfoBlock("playerSpeed".concat(t.id),{text:"".concat(t.name," | AP: ").concat(i.join(" "))})}))}},{key:"update",value:function(){Object(ve.a)(Object(h.a)(t.prototype),"update",this).call(this),this.hasWon()&&this.game.toWin(),this.hasLost()&&(qe.lose.play(),this.game.toLose(),this.reset(),this.game.initializeGameData()),this.levelComplete()&&(this.nextLevel(),this.setWaveData(),this.initialize())}},{key:"setLevel",value:function(e){this.data.level=e,this.data.turnCount=0}},{key:"nextLevel",value:function(){this.setLevel(this.data.level+1)}},{key:"reset",value:function(){this.setLevel(1),this.initialize()}},{key:"setWaveData",value:function(){var e=this.data.level-1,t=de.get(this.dataByLevel,e,{});this.data=Object(c.a)({},this.data,{},t)}},{key:"levelComplete",value:function(){var e=this.playerIsOnExit(),t=this.enemiesDefeated();return t&&this.activateExitTiles(),e&&t}},{key:"enemiesDefeated",value:function(){return this.game.engine.actors.filter((function(e){return"LOCUST"===e.faction})).length<=0}},{key:"hasWon",value:function(){return this.data.level>this.dataByLevel.length}},{key:"hasLost",value:function(){var e=this.getPlayers();return!e.length||!!(e.length&&e[0].durability<=0)}},{key:"addEmerenceHole",value:function(e){var t=this;Et(this.game.tileKey,{x:e.x-1,y:e.y-1},3,3,"EMERGENCE_GROUND",this.game.map,this.game.mapHeight,this.game.mapWidth);var a=new vt({name:"Hole",pos:e,game:this.game,passable:!0,renderer:{character:"",sprite:"\ue80a",color:Jt,background:It},timeToSpread:1,spreadCount:3,durability:1,faction:"LOCUST",speed:100,getSpawnedEntity:function(e){var a=t.getPlayers()[0],r=t.getBanditStats();return new r.entityClass({targetEntity:a,pos:e,renderer:r.renderer,name:r.name,game:t.game,actions:[],attackDamage:r.attackDamage,durability:r.durability,speed:r.speed,faction:"LOCUST",onDestroy:function(e){var a=Math.random();a<=.05?t.addAmmoLoot(e.getPosition()):a<=.1&&t.addGrenadeLoot(e.getPosition())},getProjectile:function(e){var a=e.pos,r=(e.targetPos,e.direction),n=e.range;return at(t.game.engine,Object(c.a)({},a),r,n)}})},onDestroy:function(){return t.game.map[T(e)].type="EMERGENCE_DESTROYED"}});this.game.placeActorOnMap(a)&&(this.game.engine.addActor(a),this.game.draw())}},{key:"createAmmoStack",value:function(e,t){var a=this;return Array(e).fill("").map((function(e){var r=aa(a.game.engine);return r.pos=t,r}))}},{key:"addAmmoLoot",value:function(e){var t=this;this.createAmmoStack(5,e).forEach((function(e){t.game.placeActorOnMap(e)}))}},{key:"addGrenadeLoot",value:function(e){var t=ra(this.game.engine,6);t.pos=e,this.game.placeActorOnMap(t)}},{key:"addCover",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"box",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"%",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Xt,i=A(["\ue83b","\ue873","\ue874","\ue875","\ue876","\ue877"]);switch(a){case"%":i=A(["\ue83b","\ue873"]);break;case"m":i=A(["\ue874","\ue875"]);break;case"H":i=A(["\ue876","\ue877"]);break;case"Xs":i="\ue86a";break;case"X":i="\ue86b";break;case"XL":i="\ue86c";break;default:i="\ue873"}var s=new lt({pos:e,renderer:{character:a,sprite:i,color:Vt,background:n},name:t,game:this.game,durability:r,accuracyModifer:-.3,damageModifer:0});this.game.placeActorOnMap(s)}},{key:"getBanditStats",value:function(){var e=[{name:"Grub",renderer:{character:A(["g"]),color:Qt,background:Yt,sprite:"\ue827"},durability:3,attackDamage:1,speed:100,entityClass:dt},{name:"Grub Scout",renderer:{character:A(["s"]),color:Yt,background:Qt,sprite:"\ue8d8"},durability:1,attackDamage:1,speed:500,entityClass:dt},{name:"Wretch",renderer:{character:A(["w"]),color:Yt,background:Zt,sprite:"\ue8d7"},durability:1,attackDamage:1,speed:500,entityClass:ht},{name:"Big Grub",renderer:{character:A(["B"]),color:Vt,background:Yt,sprite:"\ue8d4"},durability:4,attackDamage:3,speed:100,entityClass:ht}];return A(e)}},{key:"addGrub",value:function(e){var t=this,a=this.getPlayers()[0],r=this.getBanditStats(),n=new r.entityClass({targetEntity:a,pos:e,renderer:r.renderer,name:r.name,game:this.game,actions:[],attackDamage:r.attackDamage,durability:r.durability,speed:r.speed,faction:"LOCUST",onDestroy:function(e){var a=Math.random();a<=.05?t.addAmmoLoot(e.getPosition()):a<=.1&&t.addGrenadeLoot(e.getPosition())},getProjectile:function(e){var a=e.pos,r=(e.targetPos,e.direction),n=e.range;return at(t.game.engine,Object(c.a)({},a),r,n)}});this.game.placeActorOnMap(n)&&this.game.engine.addActor(n)}},{key:"addSkorge",value:function(e){var t=this.getPlayers()[0],a=new ht({targetEntity:t,pos:e,renderer:{sprite:"\ue8d9",character:"S",color:Yt,background:It},name:"Skorge",game:this.game,attackDamage:8,durability:40,speed:500,faction:"LOCUST"});this.game.placeActorOnMap(a)&&this.game.engine.addActor(a)}},{key:"placePlayersInSafeZone",value:function(){var e=this,t=this.getPlayers(),a=Object.keys(this.game.map).filter((function(t){return"SAFE"==e.game.map[t].type}));t.forEach((function(t){var r=a.shift();if(r){var n={x:parseInt(r.split(",")[0]),y:parseInt(r.split(",")[1])};t.pos={x:n.x,y:t.pos.y},e.game.placeActorOnMap(t)}}))}},{key:"playerIsOnExit",value:function(){var e=this.game.getFirstPlayer();if(e&&"EXIT"===this.game.map[T(e.pos)].type)return!0;return!1}},{key:"activateExitTiles",value:function(){Et(this.game.tileKey,{x:this.game.mapWidth-3,y:0},this.game.mapHeight,3,"EXIT",this.game.map,this.game.mapHeight,this.game.mapWidth)}}]),t}(function(){function e(t){var a=t.game,r=void 0===a?null:a,n=t.data,i=void 0===n?{}:n;Object(o.a)(this,e);var s=B()();this.id=s,this.game=r,this.data=i,this.infoBlocks={},this.progressBars={}}return Object(u.a)(e,[{key:"initialize",value:function(){}},{key:"update",value:function(){}},{key:"createOrUpdateInfoBlock",value:function(e,t){Object(de.merge)(this.infoBlocks,Object(Nt.a)({},e,t))}}]),e}())},ia=function(){function e(t){var a=t.engine,r=void 0===a?null:a,n=t.map,i=void 0===n?{}:n,s=t.entityMap,c=void 0===s?{}:s,u=t.entityDictionary,l=void 0===u?{}:u,h=t.mapInitialized,d=void 0!==h&&h,g=t.tileMap,p=void 0===g?{}:g,m=t.mapWidth,f=void 0===m?50:m,y=t.mapHeight,b=void 0===y?25:y,v=t.cameraWidth,O=void 0===v?50:v,k=t.cameraHeight,j=void 0===k?25:k,E=t.tileWidth,x=void 0===E?26:E,C=t.tileHeight,A=void 0===C?26:C,w=t.tileOffset,T=void 0===w?0:w,R=t.getSelectedCharacter,P=void 0===R?function(){return!1}:R,S=t.spriteMode,_=void 0===S||S,D=t.tileKey,N=void 0===D?$:D,I=t.mode,M=void 0===I?na.Flume:I,L=t.messages,G=void 0===L?[]:L;Object(o.a)(this,e),this.engine=r,this.map=i,this.entityMap=c,this.entityDictionary=l,this.mapInitialized=d,this.tileMap=p,this.mapWidth=f,this.mapHeight=b,this.cameraWidth=O,this.cameraHeight=j,this.tileWidth=x,this.tileHeight=A,this.tileOffset=T,this.display=new Te({containerId:"display",width:1300,height:650,tileWidth:x,tileHeight:A,tileOffset:T,game:this}),this.spriteMode=_,this.tileKey=N,this.mode=new M({game:this}),this.messages=G,this.getSelectedCharacter=P}return Object(u.a)(e,[{key:"initializeMode",value:function(){this.mode.initialize()}},{key:"updateMode",value:function(){this.mode.update()}},{key:"randomlyPlaceActorOnMap",value:function(e){for(var t=0,a=!1;!a;){var r=M(this.map).coordinates;if(this.canOccupyPosition(r,e)){var n=this.map[T(r)];e.pos=Object(c.a)({},r),n.entities.push(e),a=!0}(t+=1)>=100&&(a=!0)}return a}},{key:"randomlyPlaceAllActorsOnMap",value:function(){var e=this;this.engine.actors.forEach((function(t){e.randomlyPlaceActorOnMap(t)}))}},{key:"placeActorsOnMap",value:function(){var e=this;this.engine.actors.forEach((function(t){var a=e.map[T(t.pos)];a?a.entities.push(t):console.log("could not place ".concat(t.id,": ").concat(t.name," on map"))}))}},{key:"placeActorOnMap",value:function(e){var t=this.map[T(e.pos)];return t?(t.entities.push(e),!0):(console.log("could not place ".concat(e.id,": ").concat(e.name," on map")),!1)}},{key:"removeActorFromMap",value:function(e){var t=this.map[T(e.pos)];return!!t&&(this.map[T(e.pos)].entities=t.entities.filter((function(t){return t.id!==e.id})),!0)}},{key:"createLevel",value:function(){var e=new E.a.Arena(this.mapWidth,this.mapHeight),t=[];e.create(function(e,a,r){var n=e+","+a,i="GROUND",s=0;r&&(i="WALL"),this.tileKey[i].animation&&(s=w(0,this.tileKey[i].animation.length)),this.map[n]={type:i,currentFrame:s,entities:[]},t.push(n)}.bind(this)),this.randomlyPlaceAllActorsOnMap()}},{key:"createEmptyLevel",value:function(){for(var e=0;e<this.mapHeight;e++)for(var t=0;t<this.mapWidth;t++){var a="".concat(t,",").concat(e),r=0;this.tileKey.GROUND.animation&&(r=w(0,this.tileKey.GROUND.animation.length)),this.map[a]={type:"GROUND",currentFrame:r,entities:[]}}}},{key:"createCustomLevel",value:function(e){var t=this;Object.keys(e.tiles).forEach((function(a,r){var n=e.tiles[a].data.type,i=0;n||(n="GROUND"),t.tileKey[n].animation&&(i=w(0,t.tileKey[n].animation.length)),t.map[a]={type:n,currentFrame:i,entities:[]}}))}},{key:"canOccupyPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{passable:!1},a=!1,r=this.map[T(e)];if(r){var n=r.entities.filter((function(e){return!e.passable})).length>0;if(!n||t.passable){var i=this.map[T(e)];this.tileKey[i.type].passable&&(a=!0)}}return a}},{key:"rangedCursorCanOccupyPosition",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=!1,a=this.map[T(e)];if(a){var r=this.map[T(e)];this.tileKey[r.type].passable&&(t=!0)}return t}},{key:"cursorCanOccupyPosition",value:function(e){var t=!1;return this.map[T(e)]&&(t=!0),t}},{key:"show",value:function(e){this.display.initialize(e)}},{key:"getRenderMap",value:function(e,t,a,r,n,i){var s=Math.floor(a/2),c=Math.floor(r/2),o=0,u=0;t&&(o=t.x-s,u=t.y-c),o=C(o,0,n-a),u=C(u,0,i-r);var l={};for(var h in e){var d=h.split(","),g=parseInt(d[0])-o,p=parseInt(d[1])-u;g>=0&&g<=a&&p>=0&&p<=r&&(l["".concat(g,",").concat(p)]=e[h])}return l}},{key:"processTileMap",value:function(e){var t=this.getRenderMap(this.map,this.getPlayerPosition(),this.cameraWidth,this.cameraHeight,this.mapWidth,this.mapHeight);for(var a in t){var r=a.split(","),n=parseInt(r[0]),i=parseInt(r[1]),s=t[a],c=this.tileKey[s.type],o=this.animateTile(s,c),u=o.character,l=o.foreground,h=o.background,d=s.entities.filter((function(e){return e.entityTypes.includes("RENDERING")}));if(d.length>0){var g=d[d.length-1];u=(o=this.animateEntity(g)).character,l=o.foreground,o.background&&(h=o.background)}e(a,n,i,u,l,h)}}},{key:"initializeMapTiles",value:function(){var e=this;if(this.mapInitialized)return!1;this.mapInitialized=!0,this.processTileMap((function(t,a,r,n,i,s){var c=e.display.createTile(a,r,n,i,s);e.tileMap[t]=c}))}},{key:"getPlayers",value:function(){return this.engine.actors.filter((function(e){return e.entityTypes.includes("PLAYING")}))}},{key:"getFirstPlayer",value:function(){var e=this.getPlayers();return e.length?e[0]:null}},{key:"getPlayerPosition",value:function(){var e=this.getFirstPlayer();return e?e.getPosition():null}},{key:"draw",value:function(){var e=this;this.processTileMap((function(t,a,r,n,i,s){e.display.updateTile(e.tileMap[t],n,i,s)})),this.display.draw()}},{key:"getEntityRenderer",value:function(e){return this.spriteMode&&e.hasOwnProperty("sprite")?Object(c.a)({},e,{character:e.sprite,foreground:e.color}):Object(c.a)({},e,{foreground:e.color})}},{key:"getTileRenderer",value:function(e){return this.spriteMode&&e.hasOwnProperty("sprite")?Object(c.a)({},e,{character:e.sprite}):e}},{key:"animateEntity",value:function(e){var t=e.getRenderer(),a=this.getEntityRenderer(t),r=a.character,n=a.foreground,i=a.background;if(t.animation){var s=this.getEntityRenderer(t.animation[e.currentFrame]);r=s.character,n=s.foreground,i=s.background,e.currentFrame=(e.currentFrame+1)%t.animation.length}return{character:r,foreground:n,background:i}}},{key:"animateTile",value:function(e,t){var a=this.getTileRenderer(t),r=a.character,n=a.foreground,i=a.background;if(t.animation){var s=this.getTileRenderer(t.animation[e.currentFrame]);r=s.character,n=s.foreground,i=s.background,e.currentFrame=(e.currentFrame+1)%t.animation.length}return{character:r,foreground:n,background:i}}},{key:"addActor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.engine,a=this.placeActorOnMap(e);return!!a&&(t.actors.push(e),this.draw(),!0)}},{key:"placeAndDrawActor",value:function(e){this.placeActorsOnMap(),this.draw()}},{key:"removeActor",value:function(e){this.engine.actors=this.engine.actors.filter((function(t){return t.id!==e.id})),this.removeActorFromMap(e),this.draw()}},{key:"initializeUI",value:function(e,t){this.show(t),e.current.focus()}},{key:"initializeGameData",value:function(){var e=this;this.engine.game=this;var t=this.getSelectedCharacter();this.engine.actors=[t],this.engine.actors.forEach((function(t){t.game=e})),this.initializeMode(),this.draw()}},{key:"initialize",value:function(e,t){var a=this;this.initializeUI(e,t),this.initializeGameData(),setTimeout((function(){a.spriteMode=!1,a.draw()}),500),setTimeout((function(){a.spriteMode=!0,a.draw()}),500)}},{key:"addMessage",value:function(e,t){var a=new Pe({text:e,type:t});this.messages.push(a)}}]),e}(),sa=function(e,t){if(!t.isRunning){var a=t.actors[t.currentActor],r=null;try{r=a.getKeymap()}catch(i){console.log("keypress error"),console.log(i)}if(r){var n=e.key;if(!(n in r))return;(0,r[n])().setAsNextAction(),t.start()}}},ca=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=de.get(this.props.game,"mode.infoHeader",null),a=de.get(this.props.game,"mode.infoBlocks",{});return n.a.createElement("div",{className:"Instructions UI"},t&&n.a.createElement("p",{className:"flow-text"},t),n.a.createElement("div",{className:"flow-text"},de.map(a,(function(e,t){return n.a.createElement("div",{key:t,className:"Instructions__block"},e.text)})),n.a.createElement("div",{className:"Instructions__block",onClick:function(){return window.location.reload()}},n.a.createElement("button",{className:"btn btn-main"},"Restart")),n.a.createElement("div",{className:"Instructions__block",onClick:function(){return e.props.toggleSpriteMode()}},n.a.createElement("button",{className:"btn btn-main"},this.props.spriteMode?"ASCII mode":"Sprite mode")),n.a.createElement("div",{className:"Instructions__block"},n.a.createElement("button",{"data-target":"jacinto_help",className:"btn btn-main modal-trigger"},"Help"))))}}]),t}(n.a.Component);var oa=function(e){var t=e.color;return t||(t="grey"),n.a.createElement("button",{onClick:e.onClick,className:"Button btn ".concat(t)},e.children)};n.a.Component;var ua=function(e){var t=e.title,a=void 0===t?"Effect":t,r=e.text,i=void 0===r?"":r,s=e.children;return n.a.createElement("div",{className:"Tooltip"},s,n.a.createElement("div",{className:"top"},n.a.createElement("h3",null,a),n.a.createElement("p",null,i),n.a.createElement("i",null)))},la=a(22);function ha(e){var t=e.resource,a=e.superScript,r=e.canPay,i=t.renderer.sprite?t.renderer.sprite:t.renderer.character;return n.a.createElement("div",{className:"ResourceBlock",style:{backgroundColor:r?t.renderer.background:"#616161",color:r?t.renderer.color:"#bdbdbd",borderColor:r?t.renderer.color:"#bdbdbd",fontFamily:"scroll-o-script",width:a?"auto":20}},"".concat(a?a+" ":"").concat(i))}var da=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"ActionBar"},n.a.createElement("div",{className:"CharacterActions"},this.props.keymap&&Object.entries(this.props.keymap).map((function(t,a){var r=Object(la.a)(t,2),i=r[0],s=(0,r[1])(),c=de.get(s,"hidden",!1),o=de.get(s,"renderer",null),u=s.listPayableResources();if(!c)return n.a.createElement(ua,{key:"".concat(a,"-label"),title:s.label,text:s.label+" ".concat(s.actor.name)},n.a.createElement("div",{className:"CharacterActions__item",onClick:function(){s.setAsNextAction(),e.props.game.engine.isRunning||e.props.game.engine.start(),e.props.game.refocus()}},n.a.createElement("div",{className:"CharacterActions__item__label"},i),n.a.createElement("div",{className:"CharacterActions__item__content",style:o&&{backgroundColor:o.background,color:o.color,borderColor:o.color}},s.label),n.a.createElement("div",{className:"CharacterActions__item__resources"},u.map((function(e,t){var a=e.getResourceCost();return a>0&&n.a.createElement(ha,{key:"".concat(t,"-").concat(e.name,"-resource-block"),superScript:a,resource:e,canPay:e.canPay})})))))}))))}}]),t}(n.a.Component);function ga(e){var t=e.actor;return n.a.createElement("div",{className:"Portrait",style:{backgroundColor:t.renderer.background,color:t.renderer.color,borderColor:t.renderer.color}},t.renderer.sprite?t.renderer.sprite:t.renderer.character)}function pa(e){var t=e.effect;return n.a.createElement("div",{className:"StatusEffects__effect",style:{backgroundColor:t.renderer.background,color:t.renderer.color,borderColor:t.renderer.color}},t.renderer.sprite?t.renderer.sprite:t.renderer.character)}function ma(e){var t=e.actor;return n.a.createElement("div",{className:"StatusEffects"},t.game.engine.getStatusEffectsByActorId(t.id).map((function(e,t){return n.a.createElement(ua,{key:t,title:e.name,text:e.name},n.a.createElement(pa,{effect:e}))})))}function fa(e){var t=e.actor;return n.a.createElement("div",{className:"NamePlate"},t.name)}function ya(e){var t=e.actor,a=e.label,r=e.colorFilled,i=void 0===r?"red":r,s=e.colorEmpty,c=void 0===s?"gray":s,o=e.attributePathMax,u=e.attributePath,l=e.unit,h=de.get(t,o,0)/l,d=de.get(t,u,0)/l;return n.a.createElement("div",{className:"ProgressBar"},n.a.createElement("div",null,n.a.createElement("span",{className:"ProgressBar__label"},a)),n.a.createElement("div",null,n.a.createElement("div",{className:"ProgressBar__blips"},Array(h).fill(!0).map((function(e,t){return n.a.createElement("span",{key:t,className:"ProgressBar__blips__blip",style:{backgroundColor:d>t?i:c}})})))))}var ba=function(e){var t=e.actor,a=e.game;return n.a.createElement("div",{className:"CharacterCard"},n.a.createElement(ga,{actor:t}),n.a.createElement("div",null,n.a.createElement(fa,{actor:t}),n.a.createElement(ya,{label:"Action Points",attributePath:"energy",attributePathMax:"speed",colorFilled:"#ff9926",unit:100,actor:t}),n.a.createElement(ya,{label:"Health Points",attributePath:"durability",attributePathMax:"durabilityMax",colorFilled:"#dc322f",unit:1,actor:t}),n.a.createElement(ya,{label:"Upgrade Points",attributePath:"upgrade_points",attributePathMax:"upgrade_points",colorFilled:"#3e7dc9",unit:1,actor:t}),n.a.createElement(ma,{actor:t})),n.a.createElement("div",null,n.a.createElement(da,{keymap:t.getKeymap(),game:a})))},va=function(e){var t=e.game,a=t.engine.actors.filter((function(e){return e.entityTypes.includes("PRESENTING_UI")})).filter((function(e){return e.presentingUI}));return n.a.createElement("div",{className:"PlayerInformation Information UI"},n.a.createElement("div",{className:"CharacterCard_Container"},a.map((function(e,a){return n.a.createElement(ba,{key:a,actor:e,game:t})}))))};n.a.Component;function Oa(e){return n.a.createElement("div",{className:"Message",style:{color:e.color,backgroundColor:e.backgroundColor,borderColor:e.color}},e.children)}n.a.Component;var ka=a(15),ja=function(e){function t(e){var a,r=e.item,n=Object(z.a)(e,["item"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},n)))).item=r,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1;if(this.item.equipmentType){var t=this.actor.getItemInSlot(this.item.equipmentType);t&&(this.actor.addToContainer(t),this.actor.unequip(t)),this.actor.removeFromContainer(this.item),this.actor.equip(this.item.equipmentType,this.item),this.game.addMessage("".concat(this.actor.name," equips ").concat(this.item.name,"."),Re.ACTION),e=!0}return{success:e,alternative:null}}}]),t}(me);function Ea(e){var t=e.stat,a=t.getIcon,r=t.value,i=t.name,s=t.renderer.sprite?t.renderer.sprite:t.renderer.character;return n.a.createElement("div",{className:"StatBlock",style:{backgroundColor:t.renderer.background,color:t.renderer.foreground,borderColor:t.renderer.foreground,fontFamily:"scroll-o-script",width:null!==t.value?"auto":20},title:i},a?a():"".concat(s),n.a.createElement("span",null,"\xa0",r))}var xa=function(e){var t=e.game,a=e.player,r=e.data,i=r.item,s=r.equipped,c=r.amount,o=!1,u=function(){return null};if(r.equipable){var l=new ja({item:i,game:t,energyCost:0,actor:a,label:"Equip ".concat(i.name)});u=function(){t.refocus(),l.setAsNextAction(),t.engine.start()}}var h=[];return c&&h.push({name:"amount left",value:c,renderer:ta.amount}),i.hasOwnProperty("attackRange")&&h.push({name:"attack range",value:i.attackRange,renderer:ta.attackRange,getIcon:function(){return n.a.createElement(ka.b,null)}}),i.hasOwnProperty("magazine")&&(h.push({name:"shots before reload",value:i.magazine,renderer:ta.magazine,getIcon:function(){return n.a.createElement(ka.c,null)}}),i.magazine<=0&&(o=!0)),i.hasOwnProperty("baseRangedAccuracy")&&h.push({name:"base accuracy",value:"".concat(Math.round(100*i.baseRangedAccuracy),"%"),renderer:ta.baseRangedAccuracy,getIcon:function(){return n.a.createElement(ka.f,null)}}),i.hasOwnProperty("baseRangedDamage")&&h.push({name:"base damage",value:i.baseRangedDamage,renderer:ta.baseRangedDamage,getIcon:function(){return n.a.createElement(ka.d,null)}}),i.hasOwnProperty("attackDamage")&&h.push({name:"base melee damage",value:i.attackDamage,renderer:ta.meleeDamage}),n.a.createElement("div",{className:"EquipmentCard ".concat(s?"EquipmentCard--selected":""),onClick:function(){return t.refocus()}},o&&n.a.createElement("div",{className:"EquipmentCard__reload_overlay"},n.a.createElement("div",{className:"EquipmentCard__reload_overlay__text"},"Needs Reload"),n.a.createElement("div",{className:"EquipmentCard__reload_overlay__text"},n.a.createElement(ka.a,null))),n.a.createElement("div",{className:"EquipmentCard__item",onClick:u},n.a.createElement("div",{className:"EquipmentCard__item__label"},i.name),n.a.createElement("div",{className:"EquipmentCard__item__content",style:i.renderer&&{backgroundColor:i.renderer.background,color:i.renderer.color,borderColor:i.renderer.color}},i.renderer.sprite?i.renderer.sprite:i.renderer.character)),n.a.createElement("div",{className:"EquipmentCard__item__stats"},h.map((function(e,t){return n.a.createElement(Ea,{key:"".concat(t,"-").concat(e.name,"-resource-block"),stat:e})}))))},Ca=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){if(!this.props.player)return null;var e=this.props.player,t=this.props.game,a=[];return e.equipment.forEach((function(e){e.item&&a.push({item:e.item,equipped:!0})})),e.container.forEach((function(e){if(e.items.length){var t=e.items[0];if(0===a.filter((function(e){return e.item.name===t.name})).length){var r=t.entityTypes.includes("EQUIPABLE"),n=r?null:e.items.length;a.push({item:t,amount:n,equipable:r,equipped:!1})}}})),n.a.createElement("div",{className:"Equipment UI"},n.a.createElement("div",null,n.a.createElement("div",{className:"flow-text"},"Equipment"),n.a.createElement("div",null,a.map((function(a,r){return n.a.createElement(xa,{key:r,game:t,player:e,data:a})})))))}}]),t}(n.a.Component);var Aa=function(e){return n.a.useLayoutEffect((function(){var t=document.querySelectorAll("#".concat(e.id));window.M.Modal.init(t)})),n.a.createElement("div",{id:e.id,className:"Jacinto_Help modal"},n.a.createElement("div",{className:"modal-content"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col s12 m6"},n.a.createElement("div",{className:"Jacinto_Help__section_header"},"Goal"),n.a.createElement("div",{className:"Jacinto_Help__section_body"},"Defend Jacinto, the last human bastion on Sera. Move block by block and clear the city of",n.a.createElement("span",{className:"red-text"},"\xa0Grubs")," until you can locate and defeat their leader,",n.a.createElement("span",{className:"red-text"},"\xa0Skorge"),".")),n.a.createElement("div",{className:"col s12 m6"},n.a.createElement("div",{className:"Jacinto_Help__section_header"},"Hints"),n.a.createElement("div",{className:"Jacinto_Help__section_body"},n.a.createElement("div",null,"Destroy ",n.a.createElement("span",{className:"red-text"},"Emergence Holes")," ASAP."),n.a.createElement("div",null,"Spend ",n.a.createElement("span",{className:"blue-text"},"Upgrade Points"),"."),n.a.createElement("div",null,"Weapon ",n.a.createElement("span",{className:"blue-text"},"accuracy")," decreases over distance.")))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col s12"},n.a.createElement("div",{className:"Jacinto_Help__section_header"},"Controls"),n.a.createElement("div",{className:"Jacinto_Help__section_body"},n.a.createElement("div",null,"Movement: WASD"),n.a.createElement("div",null,"Actions: click or key press"))))),n.a.createElement("div",{className:"modal-footer"},n.a.createElement("a",{href:"#!",className:"modal-close waves-effect waves-green btn-flat"},"Close")))},wa=function(e){function t(e){var a;Object(o.a)(this,t),a=Object(l.a)(this,Object(h.a)(t).call(this,e));var r=new kt({}),i=new ia({engine:r,getSelectedCharacter:function(){return a.props.selectedCharacter.initialize(r)},mode:a.props.selectedMode.class});return a.state={game:i,activeTab:0,spriteMode:i.spriteMode},a.presserRef=n.a.createRef(),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=Object(j.a)(k.a.mark((function e(){var t=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.game.initialize(this.presserRef,document),this.state.game.backToTitle=function(){return t.props.setActiveScreen(m)},this.state.game.toLose=function(){t.props.setActiveScreen(y)},this.state.game.toWin=function(){t.props.setActiveScreen(b)},this.state.game.refocus=function(){return t.refocus()},this.state.game.updateReact=function(e){t.setState({game:e})},this.state.game.engine.start();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"refocus",value:function(){this.presserRef&&this.presserRef.current.focus()}},{key:"toggleSpriteMode",value:function(){this.state.game.spriteMode=!this.state.game.spriteMode,this.state.game.draw(),this.refocus(),this.setState({spriteMode:this.state.game.spriteMode})}},{key:"render",value:function(){return n.a.createElement("div",{className:"Level"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col s10"},n.a.createElement("div",{className:"game_display_container"},(e=this.presserRef,t=sa,a=this.state.game.engine,n.a.createElement("div",{id:"display",ref:e,onKeyDown:function(e){return t(e,a)},tabIndex:"0"}))),n.a.createElement(Aa,{id:"jacinto_help"}),n.a.createElement(va,{game:this.state.game}),n.a.createElement(ca,{game:this.state.game,spriteMode:this.state.game.spriteMode,setActiveScreen:this.props.setActiveScreen,toggleSpriteMode:this.toggleSpriteMode.bind(this)})),n.a.createElement("div",{className:"col s2"},n.a.createElement(Ca,{game:this.state.game,player:this.state.game.getFirstPlayer()}))));var e,t,a}}]),t}(n.a.Component),Ta=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"Title"},n.a.createElement("div",{className:"Title__content",style:{width:"100vw",height:"100vh",backgroundColor:"#07111Dff"}},n.a.createElement("div",{className:"Jacinto_Help"},n.a.createElement("div",{className:"modal-content"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col s12 m6"},n.a.createElement("div",{className:"Jacinto_Help__section_header"},"Goal"),n.a.createElement("div",{className:"Jacinto_Help__section_body"},"Defend Jacinto, the last human bastion on Sera. Move block by block and clear the city of",n.a.createElement("span",{className:"red-text"},"\xa0Grubs")," until you can locate and defeat their leader,",n.a.createElement("span",{className:"red-text"},"\xa0Skorge"),".")),n.a.createElement("div",{className:"col s12 m6"},n.a.createElement("div",{className:"Jacinto_Help__section_header"},"Hints"),n.a.createElement("div",{className:"Jacinto_Help__section_body"},n.a.createElement("div",null,"Destroy ",n.a.createElement("span",{className:"red-text"},"Emergence Holes")," ASAP."),n.a.createElement("div",null,"Spend ",n.a.createElement("span",{className:"blue-text"},"Upgrade Points"),"."),n.a.createElement("div",null,"Weapon ",n.a.createElement("span",{className:"blue-text"},"accuracy")," decreases over distance.")))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col s12"},n.a.createElement("div",{className:"Jacinto_Help__section_header"},"Controls"),n.a.createElement("div",{className:"Jacinto_Help__section_body"},n.a.createElement("div",null,"Movement: WASD"),n.a.createElement("div",null,"Actions: click or key press")))))),n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.e,null)),n.a.createElement("button",{style:{margin:"initial"},className:"CharacterSelect__button btn btn-main",onClick:function(){e.props.setActiveScreen(v)}},"Defend Jacinto"),n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.g,null))))}}]),t}(n.a.Component),Ra=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"Title"},n.a.createElement("div",{className:"Title__content",style:{width:"100vw",height:"100vh",backgroundColor:"#222"}},n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.g,null),n.a.createElement(ka.g,null),n.a.createElement(ka.g,null)),n.a.createElement("button",{style:{margin:"initial"},className:"CharacterSelect__button btn btn-main",onClick:function(){return window.location.reload()}},"Restart"),n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.g,null),n.a.createElement(ka.g,null),n.a.createElement(ka.g,null))))}}]),t}(n.a.Component),Pa=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"Title"},n.a.createElement("div",{className:"Title__content",style:{width:"100vw",height:"100vh",backgroundColor:"#3e7dc9"}},n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.e,null),n.a.createElement(ka.e,null),n.a.createElement(ka.e,null)),n.a.createElement("button",{style:{margin:"initial"},className:"CharacterSelect__button btn btn-main",onClick:function(){return window.location.reload()}},"Victory"),n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.e,null),n.a.createElement(ka.e,null),n.a.createElement(ka.e,null))))}}]),t}(n.a.Component),Sa=function(e){return n.a.createElement("div",{className:"CharacterSelect"},e.characters.map((function(t,a){return e.selectedCharacter&&(e.selectedCharacter.name===t.name?"red":""),n.a.createElement("button",{key:a,className:"CharacterSelect__button btn btn-main",onClick:function(){e.setSelectedCharacter(t),e.setActiveScreen(f)}},"Play as ",t.name)})))},_a=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"Title"},n.a.createElement("div",{className:"Title__content",style:{width:"100vw",height:"100vh",backgroundColor:"#07111Dff"}},n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.e,null)),n.a.createElement(Sa,{characters:this.props.characters,selectedCharacter:this.props.selectedCharacter,setSelectedCharacter:this.props.setSelectedCharacter,setActiveScreen:this.props.setActiveScreen}),n.a.createElement("h2",{className:"Title__header"},n.a.createElement(ka.g,null))))}}]),t}(n.a.Component),Da=function(e){return n.a.createElement("div",{className:"CharacterSelect"},e.modes.map((function(t,a){return e.selectedMode&&(e.selectedMode.name===t.name?"red":""),n.a.createElement("button",{key:a,style:{position:"relative",top:"280px"},className:"CharacterSelect__button btn btn-main",onClick:function(){console.log(t),e.setSelectedMode(t),e.setActiveScreen(v)}},t.name)})))},Na={Level:wa,Title:Ta,Win:Pa,Lose:Ra,CharacterSelect:_a,ModeSelect:function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,e))).state={},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"Title"},n.a.createElement("div",{style:{width:"100vw",height:"100vh",backgroundColor:"rgb(4, 49, 61)",backgroundImage:'url("'.concat(window.PUBLIC_URL,'/fire_man_blue.jpg")'),backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundPositionY:"10px"}},n.a.createElement(Da,{modes:this.props.modes,selectedMode:this.props.selectedMode,setSelectedMode:this.props.setSelectedMode,setActiveScreen:this.props.setActiveScreen})))}}]),t}(n.a.Component)},Ia=function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).label="Close",a.processDelay=0,a.energyCost=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){return this.actor.goToPreviousKeymap(),{success:!0,alternative:null}}}]),t}(me),Ma=function(e){function t(e){var a,r=e.passThroughEnergyCost,n=void 0===r?100:r,i=e.passThroughRequiredResources,s=void 0===i?[]:i,u=e.projectileType,d=void 0===u?tt:u,g=Object(z.a)(e,["passThroughEnergyCost","passThroughRequiredResources","projectileType"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},g)))).passThroughEnergyCost=n,a.passThroughRequiredResources=s,a.projectileType=d,a.processDelay=0,a.energyCost=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this,t=this.actor.contains(this.projectileType);if(!t)return{success:!1,alternative:null};t.game=this.game,t.pos={x:this.actor.pos.x,y:this.actor.pos.y},this.actor.removeFromContainer(t);var a=this.actor.getPosition(),r=[];[ee.N,ee.S,ee.E,ee.W].forEach((function(e,n){Array(t.range).fill("").forEach((function(t,n){n>0&&r.push(N(a,e.map((function(e){return e*n}))))}))})),this.actor.activateCursor(r);var n=new Ia({actor:this.actor,game:this.game,onAfter:function(){return e.actor.deactivateCursor()}}),i={Escape:function(){return n},w:function(){return new Ze({targetPos:Object(c.a)({},t.pos),actor:e.actor,game:e.game,entity:t,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"throw N",onBefore:function(){t.direction=ee.N},onSuccess:function(){e.actor.setNextAction(n)}})},d:function(){return new Ze({targetPos:Object(c.a)({},t.pos),actor:e.actor,game:e.game,entity:t,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"throw E",onBefore:function(){t.direction=ee.E},onSuccess:function(){e.actor.setNextAction(n)}})},s:function(){return new Ze({targetPos:Object(c.a)({},t.pos),actor:e.actor,game:e.game,entity:t,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"throw S",onBefore:function(){t.direction=ee.S},onSuccess:function(){e.actor.setNextAction(n)}})},a:function(){return new Ze({targetPos:Object(c.a)({},t.pos),actor:e.actor,game:e.game,entity:t,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"throw W",onBefore:function(){t.direction=ee.W},onSuccess:function(){e.actor.setNextAction(n)}})}};return this.actor.setKeymap(i),{success:!0,alternative:null}}}]),t}(me),La=function(e){function t(e){var a,r=e.direction,n=e.range,i=Object(z.a)(e,["direction","range"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},i)))).direction=r,a.range=n,a.processDelay=0,a.energyCost=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this,t=!1,a=this.actor.getPosition(),r=N(this.actor.getCursorPositions()[0],this.direction),n=D(a,r),i=!this.range||n.length<=this.range,s=n.reduce((function(t,a){return t&&e.game.rangedCursorCanOccupyPosition(a)}),!0);return i&&s&&this.game.rangedCursorCanOccupyPosition(r,this.actor)&&(this.actor.moveCursorInDirection(this.direction),t=!0),{success:t,alternative:null}}}]),t}(me),Ga=function(e){function t(e){var a,r=e.targetPositions,n=e.processDelay,i=void 0===n?25:n,s=Object(z.a)(e,["targetPositions","processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},s)))).targetPositions=r,a.processDelay=i,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this,t=!1;if(!this.actor.entityTypes.includes("RANGED_ATTACKING"))return{success:!0,alternative:new We({message:"Ooh I don't know how to attack",game:this.game,actor:this.actor})};var a=this.actor.getEquipedWeapons();if(a.length>0&&a[0].magazine<=0)return{success:t,alternative:null};var r=[],n={x:this.actor.pos.x,y:this.actor.pos.y},i=this.particleTemplate.renderer;return this.targetPositions.forEach((function(a){var s=e.actor.rangedAttack(a),o=Object(la.a)(s,2),u=o[0],l=o[1];r.push(a),u&&(t=!0,l?e.addParticle(r.length+1,n,null,i,he,r):(t=!0,e.addParticle(1,Object(c.a)({},a),{x:0,y:0},ue.fail.renderer)))})),{success:t,alternative:null}}}]),t}(me),qa=function(e){function t(e){var a,r=e.passThroughEnergyCost,n=void 0===r?100:r,i=e.passThroughRequiredResources,s=void 0===i?[]:i,u=Object(z.a)(e,["passThroughEnergyCost","passThroughRequiredResources"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).passThroughEnergyCost=n,a.passThroughRequiredResources=s,a.processDelay=0,a.energyCost=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"updateCursors",value:function(e,t){var a=this,r=this.actor.getCursorPositions(),n=D(t,this.actor.getCursorPositions()[0]);e.forEach((function(e){a.game.display.removeAnimation(e.id)})),n.slice(1).forEach((function(t){if(!Object(de.find)(r,{x:t.x,y:t.y})){var n=a.game.display.addAnimation(1,{x:t.x,y:t.y,color:Z.base3});e.push(n)}})),r.forEach((function(e,t){var r=a.actor.getRangedAttackChance(e);r<=0&&a.actor.changeCursorColor(t,"transparent"),r>0&&r<=.5&&a.actor.changeCursorColor(t,Z.red),r>.5&&r<=.7&&a.actor.changeCursorColor(t,Z.yellow),r>=.7&&a.actor.changeCursorColor(t,Z.green)}))}},{key:"perform",value:function(){var e=this,t=this.actor.getPosition(),a=this.actor.getAttackRange(),r=this.actor.getItemInSlot(ne),n=[Object(c.a)({},t)];r&&(n=r.getPositionsInShape(t));var i=[],s=function(){return i.forEach((function(t){e.game.display.removeAnimation(t.id)}))};this.actor.activateCursor(n),this.updateCursors(i,t);var o=new Ia({actor:this.actor,game:this.game,onAfter:function(){e.actor.deactivateCursor(),s()}}),u={Escape:function(){return o},w:function(){return new La({actor:e.actor,game:e.game,label:"move N",direction:ee.N,range:a,onSuccess:function(){e.updateCursors(i,t)}})},a:function(){return new La({actor:e.actor,game:e.game,label:"move W",direction:ee.W,range:a,onSuccess:function(){e.updateCursors(i,t)}})},s:function(){return new La({actor:e.actor,game:e.game,label:"move S",direction:ee.S,range:a,onSuccess:function(){e.updateCursors(i,t)}})},d:function(){return new La({actor:e.actor,game:e.game,label:"move E",direction:ee.E,range:a,onSuccess:function(){e.updateCursors(i,t)}})},f:function(){return new Ga({label:"Fire",targetPositions:Object(K.a)(e.actor.getCursorPositions()),game:e.game,actor:e.actor,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,onSuccess:function(){e.actor.deactivateCursor(),s(),e.actor.setNextAction(o)}})}};return this.actor.setKeymap(u),{success:!0,alternative:null}}}]),t}(me),Ua=function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).processDelay=0,a.energyCost=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this;this.game.visibleInventory=this.actor.container;var t=new Ia({actor:this.actor,game:this.game}),a={Escape:function(){return t}};return this.actor.container.forEach((function(r,n){var i=r.items[0];a[n]=function(){return new ja({item:i,game:e.game,actor:e.actor,label:"Equip ".concat(i.name),energyCost:0,onSuccess:function(){e.game.visibleInventory=null,e.actor.setNextAction(t)}})}})),this.actor.setKeymap(a),{success:!0,alternative:null}}}]),t}(me),Ha=function(e){function t(e){var a,r=e.upgrade,n=Object(z.a)(e,["upgrade"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},n)))).upgrade=r,a.particleTemplate={renderer:{sprite:"\ue8b5",character:"^",color:"white",background:"#3e7dc9"}},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this,t=!1;this.actor.upgrade(this.upgrade)&&(t=!0,q(this.actor.pos.x,this.actor.pos.y,5).forEach((function(t){e.addParticle(4,Object(c.a)({},t),{x:-1*Math.sign(t.x-e.actor.pos.x),y:-1*Math.sign(t.y-e.actor.pos.y)})})));return{success:t,alternative:null}}}]),t}(me),Wa=function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).name="Upgrade Points",a.actorResourcePath="upgrade_points",a.renderer={color:"white",background:"#3e7dc9",character:"^",sprite:"\ue8b5"},a}return Object(d.a)(t,e),t}(ge),Ba=function(e){function t(e){var a,r=Object.assign({},e);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).processDelay=0,a.energyCost=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this,t=new Ia({actor:this.actor,game:this.game}),a={Escape:function(){return t}};return this.actor.upgrade_tree.forEach((function(r,n){a[n]=function(){return new Ha({upgrade:r,game:e.game,actor:e.actor,label:"".concat(r.name),energyCost:0,requiredResources:[new Wa({getResourceCost:function(){return r.cost}})],onSuccess:function(){e.actor.setNextAction(t)}})}})),this.actor.setKeymap(a),{success:!0,alternative:null}}}]),t}(me),Fa=function(e){function t(e){var a=Object.assign({},e);return Object(o.a)(this,t),Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},a)))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this,t=!1,a=this.game.map[T(this.actor.pos)].entities.filter((function(t){return t.id!==e.actor.id}));return a.length&&a.forEach((function(a){e.game.addMessage("".concat(e.actor.name," picks up ").concat(a.name,"."),Re.ACTION),e.actor.addToContainer(a);var r=e.game.map[T(e.actor.pos)].entities;e.game.map[T(e.actor.pos)].entities=r.filter((function(e){return e.id!==a.id})),t=!0})),{success:t,alternative:null}}}]),t}(me),za=function(e){function t(e){e.message,e.messageType;var a,r=Object(z.a)(e,["message","messageType"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},r)))).processDelay=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this.actor.reload();return this.game.addMessage("".concat(this.actor.name,' says "RELOADING"'),Re.INFORMATION),{success:e,alternative:null}}}]),t}(me),Ka=function(e){var t=function(e,t){return new pt({game:e.game,name:"Lancer",passable:!0,attackRange:12,magazineSize:4,baseRangedAccuracy:.85,baseRangedDamage:2,attackDamage:2,pos:t,equipmentType:ne,renderer:{character:"L",color:Ut,background:$t}})}(e),a=new gt({pos:{x:23,y:7},renderer:{sprite:"\ue819",character:"G",color:Ut,background:Kt},name:"The Scout",actions:[],speed:800,durability:10,attackDamage:0,baseRangedAccuracy:0,baseRangedDamage:0,upgrade_points:0,upgrade_tree:[ot({cost:1,name:"+1 Health",activate:function(e){e.durabilityMax+=1,e.increaseDurability(1)}}),ot({cost:1,name:"+5% Lancer Accuracy",activate:function(e){return t.baseRangedAccuracy+=.1}}),ot({cost:2,name:"+1 Actions",activate:function(e){e.speed+=100,e.energy+=100}}),ot({cost:3,name:"Full Health",canUpgrade:function(e){return e.durability<e.durabilityMax},activate:function(e){return e.increaseDurability(e.durabilityMax-e.durability)}})],equipment:ce(),game:e.game,presentingUI:!0,faction:"COG",initializeKeymap:function(e,t){return{Escape:function(){return new We({label:"Pass",message:"pass turn...",game:e.game,actor:t,interrupt:!0,energyCost:0})},w:function(){var a=ee.N,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},s:function(){var a=ee.S,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},a:function(){var a=ee.W,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},d:function(){var a=ee.E,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},p:function(){return new We({label:"Stay",message:"standing still...",game:e.game,actor:t,energyCost:100})},f:function(){return new qa({label:"Fire Weapon",game:e.game,actor:t,passThroughEnergyCost:100,passThroughRequiredResources:[]})},r:function(){return new za({label:"Reload",game:e.game,actor:t,energyCost:100})},i:function(){return new Ua({label:"Inventory",game:e.game,actor:t})},u:function(){return new Ba({label:"Upgrade",game:e.game,actor:t})},g:function(){return new Fa({label:"Pickup",game:e.game,actor:t})},t:function(){return new Ma({label:"Grenade",projectileType:"Grenade",game:e.game,actor:t,passThroughEnergyCost:100})}}}}),r=Array(30).fill("").map((function(){return aa(e)})),n=Array(4).fill("").map((function(){return ra(e,6)})),i=function(e,t){return new pt({game:e.game,name:"Snub",passable:!0,attackRange:6,magazineSize:10,baseRangedAccuracy:.7,baseRangedDamage:1,attackDamage:1,pos:t,equipmentType:ne,renderer:{character:"S",color:Ut,background:Gt}})}(e);return a.container=[new Me({itemType:i.name,items:[i]}),new Me({itemType:r[0].name,items:r}),new Me({itemType:n[0].name,items:n})],a.equip(t.equipmentType,t),a},Xa=function(e){function t(e){var a,r=e.direction,n=e.processDelay,i=void 0===n?25:n,s=Object(z.a)(e,["direction","processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},s)))).direction=r,a.stepCount=0,a.processDelay=i,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=null,t={x:this.actor.pos.x+this.direction[0],y:this.actor.pos.y+this.direction[1]};if((e=new Be({targetPos:t,additionalDamage:this.stepCount,game:this.game,actor:this.actor,energyCost:0}),this.actor.energy>100)&&this.actor.shove(t,this.direction)){this.stepCount+=1,e=this;for(var a=0;a<3;a++)this.addParticle(1,{x:this.actor.pos.x-this.direction[0]*a,y:this.actor.pos.y-this.direction[1]*a},{x:0,y:0})}return{success:!0,alternative:e}}}]),t}(function(e){function t(e){var a,r=e.direction,n=e.stepCount,i=e.processDelay,s=void 0===i?25:i,u=Object(z.a)(e,["direction","stepCount","processDelay"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).direction=r,a.stepCount=n,a.processDelay=s,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=!1,t=null,a={x:this.actor.pos.x+this.direction[0],y:this.actor.pos.y+this.direction[1]};return this.stepCount>0&&this.actor.move(a)?(this.stepCount-=1,this.actor.setNextAction(this),e=!0):(e=!0,t=new Be({targetPos:a,game:this.game,actor:this.actor,energyCost:100})),{success:e,alternative:t}}}]),t}(me)),Ja=function(e){function t(e){var a,r=e.passThroughEnergyCost,n=void 0===r?100:r,i=e.passThroughRequiredResources,s=void 0===i?[]:i,u=Object(z.a)(e,["passThroughEnergyCost","passThroughRequiredResources"]);return Object(o.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,Object(c.a)({},u)))).passThroughEnergyCost=n,a.passThroughRequiredResources=s,a.processDelay=0,a.energyCost=0,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"perform",value:function(){var e=this,t=this.actor.getPosition(),a=[];[ee.N,ee.S,ee.E,ee.W].forEach((function(r,n){Array(e.actor.energy/100).fill("").forEach((function(e,n){n>0&&a.push(N(t,r.map((function(e){return e*n}))))}))})),this.actor.activateCursor(a);var r=new Ia({actor:this.actor,game:this.game,onAfter:function(){return e.actor.deactivateCursor()}}),n={Escape:function(){return r},w:function(){return new Xa({actor:e.actor,game:e.game,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"tackle N",direction:ee.N,particleTemplate:ue.leaf,onSuccess:function(){e.actor.deactivateCursor(),e.actor.setNextAction(r)}})},d:function(){return new Xa({actor:e.actor,game:e.game,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"tackle E",direction:ee.E,particleTemplate:ue.leaf,onSuccess:function(){e.actor.deactivateCursor(),e.actor.setNextAction(r)}})},s:function(){return new Xa({actor:e.actor,game:e.game,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"tackle S",direction:ee.S,particleTemplate:ue.leaf,onSuccess:function(){e.actor.deactivateCursor(),e.actor.setNextAction(r)}})},a:function(){return new Xa({actor:e.actor,game:e.game,energyCost:e.passThroughEnergyCost,requiredResources:e.passThroughRequiredResources,label:"tackle W",direction:ee.W,particleTemplate:ue.leaf,onSuccess:function(){e.actor.deactivateCursor(),e.actor.setNextAction(r)}})}};return this.actor.setKeymap(n),{success:!0,alternative:null}}}]),t}(me),Va=function(e){var t=function(e,t){return new pt({game:e.game,name:"Retro Lancer",passable:!0,attackRange:10,magazineSize:3,baseRangedAccuracy:.7,baseRangedDamage:2,attackDamage:6,pos:t,equipmentType:ne,renderer:{character:"R",color:Ut,background:zt}})}(e),a=new gt({pos:{x:23,y:7},renderer:{sprite:"\ue819",character:"G",color:Ut,background:Kt},name:"The Veteran",speed:400,durability:20,baseRangedAccuracy:0,baseRangedDamage:0,attackDamage:0,upgrade_points:0,upgrade_tree:[ot({cost:1,name:"+1 Health",activate:function(e){e.durabilityMax+=1,e.increaseDurability(1)}}),ot({cost:1,name:"+2 Melee Damage",activate:function(e){return t.attackDamage+=2}}),ot({cost:3,name:"Full Health",canUpgrade:function(e){return e.durability<e.durabilityMax},activate:function(e){return e.increaseDurability(e.durabilityMax-e.durability)}})],equipment:ce(),game:e.game,presentingUI:!0,faction:"COG",initializeKeymap:function(e,t){return{Escape:function(){return new We({label:"Pass",message:"pass turn...",game:e.game,actor:t,interrupt:!0,energyCost:0})},w:function(){var a=ee.N,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},s:function(){var a=ee.S,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},a:function(){var a=ee.W,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},d:function(){var a=ee.E,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},p:function(){return new We({label:"Stay",message:"standing still...",game:e.game,actor:t,energyCost:100})},f:function(){return new qa({label:"Fire Weapon",game:e.game,actor:t,passThroughEnergyCost:100,passThroughRequiredResources:[]})},r:function(){return new za({label:"Reload",game:e.game,actor:t,energyCost:100})},i:function(){return new Ua({label:"Inventory",game:e.game,actor:t})},u:function(){return new Ba({label:"Upgrade",game:e.game,actor:t})},g:function(){return new Fa({label:"Pickup",game:e.game,actor:t})},t:function(){return new Ma({label:"Grenade",projectileType:"Grenade",game:e.game,actor:t,passThroughEnergyCost:100})},c:function(){return new Ja({label:"Bayonet Charge",game:e.game,actor:t,passThroughEnergyCost:100})}}}}),r=Array(10).fill("").map((function(){return aa(e)})),n=Array(2).fill("").map((function(){return ra(e,6)})),i=function(e,t){return new pt({game:e.game,name:"Gnasher",passable:!0,attackRange:4,magazineSize:2,baseRangedAccuracy:.9,baseRangedDamage:3,attackDamage:0,pos:t,shapePattern:oe.square,equipmentType:ne,renderer:{character:"G",color:Mt,background:Ft}})}(e);return a.container=[new Me({itemType:i.name,items:[i]}),new Me({itemType:r[0].name,items:r}),new Me({itemType:n[0].name,items:n})],a.equip(t.equipmentType,t),a},Ya=function(e){var t=function(e,t){return new pt({game:e.game,name:"Longshot",passable:!0,attackRange:20,magazineSize:1,baseRangedAccuracy:1,baseRangedDamage:10,attackDamage:0,pos:t,equipmentType:ne,renderer:{character:"L",color:qt,background:It}})}(e),a=function(e,t){return new pt({game:e.game,name:"Boltok",passable:!0,attackRange:4,magazineSize:2,baseRangedAccuracy:.8,baseRangedDamage:3,attackDamage:1,pos:t,equipmentType:ne,renderer:{character:"B",color:Ut,background:Xt}})}(e),r=new gt({pos:{x:23,y:7},renderer:{sprite:"\ue819",character:"G",color:Ut,background:Kt},name:"The Stranded",speed:600,durability:12,baseRangedAccuracy:0,baseRangedDamage:0,attackDamage:0,upgrade_points:0,upgrade_tree:[ot({cost:1,name:"+1 Health",activate:function(e){e.durabilityMax+=1,e.increaseDurability(1)}}),ot({cost:1,name:"+5% Longshot Accuracy",activate:function(e){return t.baseRangedAccuracy+=.05}}),ot({cost:1,name:"+5% Boltok Accuracy",activate:function(e){return a.baseRangedAccuracy+=.05}}),ot({cost:1,name:"Craft 3 Grenades",activate:function(t){Array(3).fill("").map((function(){return t.addToContainer(ra(e,6))}))}}),ot({cost:3,name:"Full Health",canUpgrade:function(e){return e.durability<e.durabilityMax},activate:function(e){return e.increaseDurability(e.durabilityMax-e.durability)}})],equipment:ce(),game:e.game,presentingUI:!0,faction:"COG",initializeKeymap:function(e,t){return{Escape:function(){return new We({label:"Pass",message:"pass turn...",game:e.game,actor:t,interrupt:!0,energyCost:0})},w:function(){var a=ee.N,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},s:function(){var a=ee.S,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},a:function(){var a=ee.W,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},d:function(){var a=ee.E,r=t.pos.x+a[0],n=t.pos.y+a[1];return new Fe({hidden:!0,targetPos:{x:r,y:n},game:e.game,actor:t,energyCost:100})},p:function(){return new We({label:"Stay",message:"standing still...",game:e.game,actor:t,energyCost:100})},f:function(){return new qa({label:"Fire Weapon",game:e.game,actor:t,passThroughEnergyCost:100,passThroughRequiredResources:[]})},r:function(){return new za({label:"Reload",game:e.game,actor:t,energyCost:100})},i:function(){return new Ua({label:"Inventory",game:e.game,actor:t})},u:function(){return new Ba({label:"Upgrade",game:e.game,actor:t})},g:function(){return new Fa({label:"Pickup",game:e.game,actor:t})},t:function(){return new Ma({label:"Grenade",projectileType:"Grenade",game:e.game,actor:t,passThroughEnergyCost:100})}}}}),n=Array(20).fill("").map((function(){return aa(e)})),i=Array(2).fill("").map((function(){return ra(e,6)}));return r.container=[new Me({itemType:a.name,items:[a]}),new Me({itemType:n[0].name,items:n}),new Me({itemType:i[0].name,items:i})],r.equip(t.equipmentType,t),r},Qa=function(){return{The_Scout:Ka,The_Veteran:Va,The_Stranded:Ya}},Za=function(e){function t(){var e;Object(o.a)(this,t),e=Object(l.a)(this,Object(h.a)(t).call(this));var a=Qa(),r=Object.keys(a).map((function(e,t){return{initialize:a[e],selected:!1,name:e.split("_").join(" ")}})),n=Object.keys(na).map((function(e,t){return{class:na[e],selected:!1,name:e.split("_").join(" ")}}));return e.state={activeScreen:m,characters:r,modes:n,selectedCharacter:null,selectedMode:n[0]},e}return Object(d.a)(t,e),Object(u.a)(t,[{key:"setActiveScreen",value:function(e){e===m&&Object.keys(qe).forEach((function(e){qe[e].stop()})),this.setState({activeScreen:e})}},{key:"setSelectedCharacter",value:function(e){this.setState({selectedCharacter:Object(c.a)({},e)})}},{key:"setSelectedMode",value:function(e){this.setState({selectedMode:e})}},{key:"getActiveScreen",value:function(){var e=n.a.createElement(Na.CharacterSelect,{key:v,setActiveScreen:this.setActiveScreen.bind(this),setSelectedCharacter:this.setSelectedCharacter.bind(this),selectedCharacter:this.state.selectedCharacter,characters:this.state.characters}),t=n.a.createElement(Na.Title,{key:m,setActiveScreen:this.setActiveScreen.bind(this),setSelectedCharacter:this.setSelectedCharacter.bind(this),selectedCharacter:this.state.selectedCharacter,characters:this.state.characters}),a=n.a.createElement(Na.Lose,{key:y,setActiveScreen:this.setActiveScreen.bind(this),setSelectedCharacter:this.setSelectedCharacter.bind(this),selectedCharacter:this.state.selectedCharacter,characters:this.state.characters}),r=n.a.createElement(Na.Win,{key:b,setActiveScreen:this.setActiveScreen.bind(this),setSelectedCharacter:this.setSelectedCharacter.bind(this),selectedCharacter:this.state.selectedCharacter,characters:this.state.characters}),i=n.a.createElement(Na.Level,{key:f,setActiveScreen:this.setActiveScreen.bind(this),selectedCharacter:this.state.selectedCharacter,selectedMode:this.state.selectedMode});switch(this.state.activeScreen){case v:return e;case m:return t;case y:return a;case b:return r;case f:return i;default:return t}}},{key:"render",value:function(){var e=this.getActiveScreen();return n.a.createElement("div",{className:"Nystrum"},n.a.createElement(p.a,{transitionName:"fade",transitionAppear:!0,transitionEnter:!0,transitionLeave:!0,transitionAppearTimeout:500,transitionEnterTimeout:500,transitionLeaveTimeout:300},e))}}]),t}(n.a.Component);var $a=function(){return n.a.createElement("div",{className:"App container-fluid"},n.a.createElement(Za,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement($a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[143,1,2]]]);
//# sourceMappingURL=main.e7eacfa8.chunk.js.map